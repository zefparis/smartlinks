2025-08-19 14:36:56,486 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 14:36:56,490 - __main__ - INFO - Initializing database...
2025-08-19 14:36:56,666 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 14:36:56,672 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 14:36:56,680 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 14:36:56,682 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 14:36:56,687 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 14:36:56,689 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 14:36:56,696 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:36:56,705 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:36:56,715 - sqlalchemy.engine.Engine - INFO - [generated in 0.01180s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:36:56,723 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:36:56,735 - sqlalchemy.engine.Engine - INFO - [cached since 0.03111s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:36:56,737 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:36:56,746 - sqlalchemy.engine.Engine - INFO - [cached since 0.04179s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:36:56,765 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:36:56,765 - sqlalchemy.engine.Engine - INFO - [cached since 0.06162s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:36:56,769 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:36:56,769 - sqlalchemy.engine.Engine - INFO - [cached since 0.06528s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:36:56,772 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:36:56,773 - sqlalchemy.engine.Engine - INFO - [cached since 0.06917s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:36:56,777 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:36:56,789 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 14:36:56,790 - __main__ - INFO - Ensuring default segments exist
2025-08-19 14:36:56,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:36:56,853 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:36:56,855 - sqlalchemy.engine.Engine - INFO - [generated in 0.00157s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 14:36:56,862 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:36:56,864 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:36:56,865 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:36:56,867 - sqlalchemy.engine.Engine - INFO - [cached since 0.01384s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 14:36:56,869 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:36:56,870 - __main__ - INFO - Default segments ensured
2025-08-19 14:36:56,872 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 14:36:56,873 - __main__ - INFO - Starting autopilot iteration
2025-08-19 14:36:56,874 - __main__ - INFO - Fetching all segments
2025-08-19 14:36:56,877 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:36:56,884 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 14:36:56,885 - sqlalchemy.engine.Engine - INFO - [generated in 0.00103s] {}
2025-08-19 14:36:56,887 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 14:36:56,893 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 14:36:56,897 - sqlalchemy.engine.Engine - INFO - [generated in 0.00338s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755347816, 'status_1': 'approved'}
2025-08-19 14:36:56,915 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 14:36:56,918 - sqlalchemy.engine.Engine - INFO - [generated in 0.00168s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755347816, 'valid_final_1': 1}
2025-08-19 14:36:56,920 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 14:36:56,922 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:36:56,923 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 14:36:56,937 - sqlalchemy.engine.Engine - INFO - [generated in 0.01387s] {'threshold': 0.8, 'since': 1755347816, 'seg_id': 'FR:mobile'}
2025-08-19 14:36:56,940 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 14:36:56,943 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:36:56,949 - sqlalchemy.engine.Engine - INFO - [generated in 0.00705s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 14:36:56,957 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 14:36:56,964 - sqlalchemy.engine.Engine - INFO - [generated in 0.00735s] {'updated_at': 1755607016, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 14:36:56,967 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:36:56,971 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 14:36:56,973 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:36:56,976 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 14:36:56,979 - sqlalchemy.engine.Engine - INFO - [cached since 0.08597s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755347816, 'status_1': 'approved'}
2025-08-19 14:36:56,983 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 14:36:56,984 - sqlalchemy.engine.Engine - INFO - [cached since 0.06832s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755347816, 'valid_final_1': 1}
2025-08-19 14:36:56,985 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 14:36:56,988 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:36:56,989 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 14:36:56,990 - sqlalchemy.engine.Engine - INFO - [cached since 0.06777s ago] {'threshold': 0.8, 'since': 1755347816, 'seg_id': 'FR:desktop'}
2025-08-19 14:36:56,995 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 14:36:57,002 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:36:57,003 - sqlalchemy.engine.Engine - INFO - [cached since 0.06105s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 14:36:57,005 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 14:36:57,007 - sqlalchemy.engine.Engine - INFO - [cached since 0.05051s ago] {'updated_at': 1755607017, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 14:36:57,032 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:36:57,035 - __main__ - INFO - DB session closed
2025-08-19 14:36:57,036 - __main__ - INFO - Payout rates updated @ 2025-08-19 14:36:57 (took 0.16s)
2025-08-19 14:46:56,874 - __main__ - INFO - Starting autopilot iteration
2025-08-19 14:46:56,875 - __main__ - INFO - Fetching all segments
2025-08-19 14:46:56,980 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:46:56,981 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 14:46:56,983 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {}
2025-08-19 14:46:56,986 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 14:46:56,989 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 14:46:56,989 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755348416, 'status_1': 'approved'}
2025-08-19 14:46:57,001 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 14:46:57,001 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'segment_id_1': 'FR:mobile', 'ts_1': 1755348416, 'valid_final_1': 1}
2025-08-19 14:46:57,005 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 14:46:57,007 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:46:57,008 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 14:46:57,010 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'threshold': 0.8, 'since': 1755348417, 'seg_id': 'FR:mobile'}
2025-08-19 14:46:57,012 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 14:46:57,014 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:46:57,014 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 14:46:57,018 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 14:46:57,019 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'updated_at': 1755607617, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 14:46:57,020 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:46:57,026 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 14:46:57,028 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:46:57,029 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 14:46:57,030 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755348417, 'status_1': 'approved'}
2025-08-19 14:46:57,034 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 14:46:57,035 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755348417, 'valid_final_1': 1}
2025-08-19 14:46:57,037 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 14:46:57,039 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:46:57,040 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 14:46:57,041 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'threshold': 0.8, 'since': 1755348417, 'seg_id': 'FR:desktop'}
2025-08-19 14:46:57,043 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 14:46:57,044 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:46:57,045 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 14:46:57,047 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 14:46:57,048 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'updated_at': 1755607617, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 14:46:57,050 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:46:57,052 - __main__ - INFO - DB session closed
2025-08-19 14:46:57,053 - __main__ - INFO - Payout rates updated @ 2025-08-19 14:46:57 (took 0.18s)
2025-08-19 14:47:39,239 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 14:47:39,252 - __main__ - INFO - Initializing database...
2025-08-19 14:47:39,426 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 14:47:39,432 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 14:47:39,439 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 14:47:39,443 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 14:47:39,445 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 14:47:39,453 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 14:47:39,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:47:39,575 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:47:39,643 - sqlalchemy.engine.Engine - INFO - [generated in 0.06806s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:47:39,739 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:47:39,827 - sqlalchemy.engine.Engine - INFO - [cached since 0.2526s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:47:39,891 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:47:39,962 - sqlalchemy.engine.Engine - INFO - [cached since 0.3869s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:47:39,968 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:47:39,971 - sqlalchemy.engine.Engine - INFO - [cached since 0.3957s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:47:39,974 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:47:39,974 - sqlalchemy.engine.Engine - INFO - [cached since 0.3994s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:47:39,978 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:47:39,980 - sqlalchemy.engine.Engine - INFO - [cached since 0.4048s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:47:39,985 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:47:39,988 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 14:47:39,989 - __main__ - INFO - Ensuring default segments exist
2025-08-19 14:47:40,033 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:47:40,074 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:47:40,105 - sqlalchemy.engine.Engine - INFO - [generated in 0.03131s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 14:47:40,159 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:47:40,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:47:40,167 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:47:40,178 - sqlalchemy.engine.Engine - INFO - [cached since 0.1038s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 14:47:40,182 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:47:40,188 - __main__ - INFO - Default segments ensured
2025-08-19 14:47:40,192 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 14:47:40,192 - __main__ - INFO - Starting autopilot iteration
2025-08-19 14:47:40,194 - __main__ - INFO - Fetching all segments
2025-08-19 14:47:40,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:47:40,200 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 14:47:40,203 - sqlalchemy.engine.Engine - INFO - [generated in 0.00332s] {}
2025-08-19 14:47:40,206 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 14:47:40,213 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 14:47:40,215 - sqlalchemy.engine.Engine - INFO - [generated in 0.00251s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755348460, 'status_1': 'approved'}
2025-08-19 14:47:40,259 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 14:47:40,263 - sqlalchemy.engine.Engine - INFO - [generated in 0.00649s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755348460, 'valid_final_1': 1}
2025-08-19 14:47:40,299 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 14:47:40,309 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:47:40,311 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 14:47:40,312 - sqlalchemy.engine.Engine - INFO - [generated in 0.00154s] {'threshold': 0.8, 'since': 1755348460, 'seg_id': 'FR:mobile'}
2025-08-19 14:47:40,317 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 14:47:40,330 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:47:40,348 - sqlalchemy.engine.Engine - INFO - [generated in 0.01748s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 14:47:40,362 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 14:47:40,367 - sqlalchemy.engine.Engine - INFO - [generated in 0.00478s] {'updated_at': 1755607660, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 14:47:40,375 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:47:40,381 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 14:47:40,385 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:47:40,389 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 14:47:40,390 - sqlalchemy.engine.Engine - INFO - [cached since 0.1767s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755348460, 'status_1': 'approved'}
2025-08-19 14:47:40,394 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 14:47:40,395 - sqlalchemy.engine.Engine - INFO - [cached since 0.1383s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755348460, 'valid_final_1': 1}
2025-08-19 14:47:40,404 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 14:47:40,410 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:47:40,412 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 14:47:40,414 - sqlalchemy.engine.Engine - INFO - [cached since 0.1036s ago] {'threshold': 0.8, 'since': 1755348460, 'seg_id': 'FR:desktop'}
2025-08-19 14:47:40,417 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 14:47:40,420 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:47:40,422 - sqlalchemy.engine.Engine - INFO - [cached since 0.09149s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 14:47:40,426 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 14:47:40,428 - sqlalchemy.engine.Engine - INFO - [cached since 0.06545s ago] {'updated_at': 1755607660, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 14:47:40,431 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:47:40,440 - __main__ - INFO - DB session closed
2025-08-19 14:47:40,443 - __main__ - INFO - Payout rates updated @ 2025-08-19 14:47:40 (took 0.25s)
2025-08-19 14:52:30,186 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 14:52:30,196 - __main__ - INFO - Initializing database...
2025-08-19 14:52:30,398 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 14:52:30,403 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 14:52:30,408 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 14:52:30,414 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 14:52:30,425 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 14:52:30,431 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 14:52:30,436 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:52:30,455 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:52:30,457 - sqlalchemy.engine.Engine - INFO - [generated in 0.00226s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:52:30,470 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:52:30,471 - sqlalchemy.engine.Engine - INFO - [cached since 0.01697s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:52:30,493 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:52:30,499 - sqlalchemy.engine.Engine - INFO - [cached since 0.0455s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:52:30,502 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:52:30,504 - sqlalchemy.engine.Engine - INFO - [cached since 0.04888s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:52:30,506 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:52:30,519 - sqlalchemy.engine.Engine - INFO - [cached since 0.06479s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:52:30,521 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 14:52:30,523 - sqlalchemy.engine.Engine - INFO - [cached since 0.06856s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 14:52:30,533 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:52:30,537 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 14:52:30,539 - __main__ - INFO - Ensuring default segments exist
2025-08-19 14:52:30,587 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:52:30,602 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:52:30,607 - sqlalchemy.engine.Engine - INFO - [generated in 0.00444s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 14:52:30,632 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:52:30,639 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:52:30,640 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:52:30,645 - sqlalchemy.engine.Engine - INFO - [cached since 0.04234s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 14:52:30,648 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:52:30,651 - __main__ - INFO - Default segments ensured
2025-08-19 14:52:30,652 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 14:52:30,653 - __main__ - INFO - Starting autopilot iteration
2025-08-19 14:52:30,657 - __main__ - INFO - Fetching all segments
2025-08-19 14:52:30,680 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:52:30,684 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 14:52:30,698 - sqlalchemy.engine.Engine - INFO - [generated in 0.01411s] {}
2025-08-19 14:52:30,714 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 14:52:30,721 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 14:52:30,722 - sqlalchemy.engine.Engine - INFO - [generated in 0.00247s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755348750, 'status_1': 'approved'}
2025-08-19 14:52:30,744 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 14:52:30,770 - sqlalchemy.engine.Engine - INFO - [generated in 0.02630s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755348750, 'valid_final_1': 1}
2025-08-19 14:52:30,773 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 14:52:30,775 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:52:30,780 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 14:52:30,783 - sqlalchemy.engine.Engine - INFO - [generated in 0.00230s] {'threshold': 0.8, 'since': 1755348750, 'seg_id': 'FR:mobile'}
2025-08-19 14:52:30,789 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 14:52:30,795 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:52:30,797 - sqlalchemy.engine.Engine - INFO - [generated in 0.00181s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 14:52:30,804 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 14:52:30,807 - sqlalchemy.engine.Engine - INFO - [generated in 0.00300s] {'updated_at': 1755607950, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 14:52:30,813 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:52:30,818 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 14:52:30,821 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:52:30,825 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 14:52:30,829 - sqlalchemy.engine.Engine - INFO - [cached since 0.1081s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755348750, 'status_1': 'approved'}
2025-08-19 14:52:30,832 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 14:52:30,837 - sqlalchemy.engine.Engine - INFO - [cached since 0.09353s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755348750, 'valid_final_1': 1}
2025-08-19 14:52:30,843 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 14:52:30,847 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 14:52:30,848 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 14:52:30,854 - sqlalchemy.engine.Engine - INFO - [cached since 0.07263s ago] {'threshold': 0.8, 'since': 1755348750, 'seg_id': 'FR:desktop'}
2025-08-19 14:52:30,855 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 14:52:30,857 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 14:52:30,862 - sqlalchemy.engine.Engine - INFO - [cached since 0.0665s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 14:52:30,865 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 14:52:30,865 - sqlalchemy.engine.Engine - INFO - [cached since 0.06223s ago] {'updated_at': 1755607950, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 14:52:30,869 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 14:52:30,870 - __main__ - INFO - DB session closed
2025-08-19 14:52:30,870 - __main__ - INFO - Payout rates updated @ 2025-08-19 14:52:30 (took 0.22s)
2025-08-19 15:07:19,907 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 15:07:19,907 - __main__ - INFO - Initializing database...
2025-08-19 15:07:20,060 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 15:07:20,061 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:07:20,067 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 15:07:20,071 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:07:20,076 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 15:07:20,079 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:07:20,087 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:07:20,098 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:07:20,100 - sqlalchemy.engine.Engine - INFO - [generated in 0.00252s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:07:20,106 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:07:20,108 - sqlalchemy.engine.Engine - INFO - [cached since 0.01047s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:07:20,110 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:07:20,110 - sqlalchemy.engine.Engine - INFO - [cached since 0.01383s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:07:20,113 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:07:20,117 - sqlalchemy.engine.Engine - INFO - [cached since 0.01977s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:07:20,120 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:07:20,121 - sqlalchemy.engine.Engine - INFO - [cached since 0.02308s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:07:20,123 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:07:20,123 - sqlalchemy.engine.Engine - INFO - [cached since 0.02656s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:07:20,127 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:07:20,127 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 15:07:20,129 - __main__ - INFO - Ensuring default segments exist
2025-08-19 15:07:20,170 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:07:20,175 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:07:20,175 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:07:20,181 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:07:20,186 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:07:20,188 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:07:20,188 - sqlalchemy.engine.Engine - INFO - [cached since 0.01445s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:07:20,191 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:07:20,193 - __main__ - INFO - Default segments ensured
2025-08-19 15:07:20,195 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 15:07:20,195 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:07:20,198 - __main__ - INFO - Fetching all segments
2025-08-19 15:07:20,200 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:07:20,203 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:07:20,205 - sqlalchemy.engine.Engine - INFO - [generated in 0.00167s] {}
2025-08-19 15:07:20,206 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:07:20,213 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:07:20,217 - sqlalchemy.engine.Engine - INFO - [generated in 0.00577s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755349640, 'status_1': 'approved'}
2025-08-19 15:07:20,235 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:07:20,240 - sqlalchemy.engine.Engine - INFO - [generated in 0.00409s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755349640, 'valid_final_1': 1}
2025-08-19 15:07:20,242 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:07:20,243 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:07:20,245 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:07:20,250 - sqlalchemy.engine.Engine - INFO - [generated in 0.00582s] {'threshold': 0.8, 'since': 1755349640, 'seg_id': 'FR:mobile'}
2025-08-19 15:07:20,254 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:07:20,259 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:07:20,259 - sqlalchemy.engine.Engine - INFO - [generated in 0.00106s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:07:20,268 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:07:20,268 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] {'updated_at': 1755608840, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 15:07:20,271 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:07:20,272 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:07:20,277 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:07:20,277 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:07:20,277 - sqlalchemy.engine.Engine - INFO - [cached since 0.06593s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755349640, 'status_1': 'approved'}
2025-08-19 15:07:20,283 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:07:20,285 - sqlalchemy.engine.Engine - INFO - [cached since 0.05021s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755349640, 'valid_final_1': 1}
2025-08-19 15:07:20,287 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:07:20,290 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:07:20,290 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:07:20,292 - sqlalchemy.engine.Engine - INFO - [cached since 0.04665s ago] {'threshold': 0.8, 'since': 1755349640, 'seg_id': 'FR:desktop'}
2025-08-19 15:07:20,292 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:07:20,292 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:07:20,292 - sqlalchemy.engine.Engine - INFO - [cached since 0.03655s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:07:20,301 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:07:20,301 - sqlalchemy.engine.Engine - INFO - [cached since 0.0337s ago] {'updated_at': 1755608840, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 15:07:20,304 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:07:20,306 - __main__ - INFO - DB session closed
2025-08-19 15:07:20,306 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:07:20 (took 0.11s)
2025-08-19 15:17:20,196 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:17:20,196 - __main__ - INFO - Fetching all segments
2025-08-19 15:17:20,296 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:17:20,296 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:17:20,296 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {}
2025-08-19 15:17:20,304 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:17:20,305 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:17:20,306 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755350240, 'status_1': 'approved'}
2025-08-19 15:17:20,315 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:17:20,316 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'segment_id_1': 'FR:mobile', 'ts_1': 1755350240, 'valid_final_1': 1}
2025-08-19 15:17:20,318 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:17:20,318 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:17:20,318 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:17:20,318 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'threshold': 0.8, 'since': 1755350240, 'seg_id': 'FR:mobile'}
2025-08-19 15:17:20,322 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:17:20,322 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:17:20,324 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:17:20,327 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:17:20,327 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'updated_at': 1755609440, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 15:17:20,332 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:17:20,332 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:17:20,339 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:17:20,340 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:17:20,340 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755350240, 'status_1': 'approved'}
2025-08-19 15:17:20,342 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:17:20,343 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755350240, 'valid_final_1': 1}
2025-08-19 15:17:20,348 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:17:20,348 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:17:20,348 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:17:20,348 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'threshold': 0.8, 'since': 1755350240, 'seg_id': 'FR:desktop'}
2025-08-19 15:17:20,352 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:17:20,354 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:17:20,354 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:17:20,356 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:17:20,356 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] {'updated_at': 1755609440, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 15:17:20,359 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:17:20,359 - __main__ - INFO - DB session closed
2025-08-19 15:17:20,359 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:17:20 (took 0.16s)
2025-08-19 15:18:03,282 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 15:18:03,292 - __main__ - INFO - Initializing database...
2025-08-19 15:18:03,515 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 15:18:03,534 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:18:03,536 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 15:18:03,548 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:18:03,550 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 15:18:03,565 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:18:03,582 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:18:03,596 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:18:03,599 - sqlalchemy.engine.Engine - INFO - [generated in 0.00215s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:18:03,608 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:18:03,614 - sqlalchemy.engine.Engine - INFO - [cached since 0.01684s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:18:03,615 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:18:03,617 - sqlalchemy.engine.Engine - INFO - [cached since 0.02038s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:18:03,620 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:18:03,625 - sqlalchemy.engine.Engine - INFO - [cached since 0.02734s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:18:03,633 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:18:03,635 - sqlalchemy.engine.Engine - INFO - [cached since 0.03801s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:18:03,638 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:18:03,645 - sqlalchemy.engine.Engine - INFO - [cached since 0.04884s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:18:03,648 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:18:03,650 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 15:18:03,652 - __main__ - INFO - Ensuring default segments exist
2025-08-19 15:18:03,698 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:18:03,709 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:18:03,712 - sqlalchemy.engine.Engine - INFO - [generated in 0.00361s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:18:03,720 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:18:03,727 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:18:03,730 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:18:03,733 - sqlalchemy.engine.Engine - INFO - [cached since 0.02307s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:18:03,735 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:18:03,737 - __main__ - INFO - Default segments ensured
2025-08-19 15:18:03,740 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 15:18:03,766 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:18:03,766 - __main__ - INFO - Fetching all segments
2025-08-19 15:18:03,770 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:18:03,787 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:18:03,797 - sqlalchemy.engine.Engine - INFO - [generated in 0.00925s] {}
2025-08-19 15:18:03,798 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:18:03,809 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:18:03,812 - sqlalchemy.engine.Engine - INFO - [generated in 0.00433s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755350283, 'status_1': 'approved'}
2025-08-19 15:18:03,881 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:18:03,903 - sqlalchemy.engine.Engine - INFO - [generated in 0.02323s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755350283, 'valid_final_1': 1}
2025-08-19 15:18:03,912 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:18:03,925 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:18:03,935 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:18:03,935 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] {'threshold': 0.8, 'since': 1755350283, 'seg_id': 'FR:mobile'}
2025-08-19 15:18:03,942 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:18:03,948 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:18:03,952 - sqlalchemy.engine.Engine - INFO - [generated in 0.00449s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:18:03,962 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:18:03,966 - sqlalchemy.engine.Engine - INFO - [generated in 0.00334s] {'updated_at': 1755609483, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 15:18:03,968 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:18:03,975 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:18:03,984 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:18:03,987 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:18:03,995 - sqlalchemy.engine.Engine - INFO - [cached since 0.1867s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755350283, 'status_1': 'approved'}
2025-08-19 15:18:03,999 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:18:04,001 - sqlalchemy.engine.Engine - INFO - [cached since 0.12s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755350283, 'valid_final_1': 1}
2025-08-19 15:18:04,004 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:18:04,015 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:18:04,015 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:18:04,017 - sqlalchemy.engine.Engine - INFO - [cached since 0.08189s ago] {'threshold': 0.8, 'since': 1755350284, 'seg_id': 'FR:desktop'}
2025-08-19 15:18:04,019 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:18:04,020 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:18:04,022 - sqlalchemy.engine.Engine - INFO - [cached since 0.07427s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:18:04,030 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:18:04,032 - sqlalchemy.engine.Engine - INFO - [cached since 0.06866s ago] {'updated_at': 1755609484, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 15:18:04,034 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:18:04,042 - __main__ - INFO - DB session closed
2025-08-19 15:18:04,047 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:18:04 (took 0.28s)
2025-08-19 15:22:56,144 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 15:22:56,144 - __main__ - INFO - Initializing database...
2025-08-19 15:22:56,288 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 15:22:56,292 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:22:56,305 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 15:22:56,307 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:22:56,310 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 15:22:56,310 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:22:56,314 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:22:56,326 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:22:56,327 - sqlalchemy.engine.Engine - INFO - [generated in 0.00131s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:22:56,334 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:22:56,336 - sqlalchemy.engine.Engine - INFO - [cached since 0.01051s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:22:56,339 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:22:56,340 - sqlalchemy.engine.Engine - INFO - [cached since 0.01419s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:22:56,341 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:22:56,342 - sqlalchemy.engine.Engine - INFO - [cached since 0.01692s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:22:56,342 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:22:56,346 - sqlalchemy.engine.Engine - INFO - [cached since 0.01972s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:22:56,349 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:22:56,349 - sqlalchemy.engine.Engine - INFO - [cached since 0.02585s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:22:56,352 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:22:56,355 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 15:22:56,355 - __main__ - INFO - Ensuring default segments exist
2025-08-19 15:22:56,389 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:22:56,392 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:22:56,392 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:22:56,402 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:22:56,403 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:22:56,406 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:22:56,407 - sqlalchemy.engine.Engine - INFO - [cached since 0.0142s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:22:56,407 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:22:56,410 - __main__ - INFO - Default segments ensured
2025-08-19 15:22:56,410 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 15:22:56,412 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:22:56,412 - __main__ - INFO - Fetching all segments
2025-08-19 15:22:56,414 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:22:56,417 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:22:56,419 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] {}
2025-08-19 15:22:56,419 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:22:56,422 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:22:56,422 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755350576, 'status_1': 'approved'}
2025-08-19 15:22:56,443 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:22:56,443 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755350576, 'valid_final_1': 1}
2025-08-19 15:22:56,443 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:22:56,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:22:56,452 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:22:56,453 - sqlalchemy.engine.Engine - INFO - [generated in 0.00123s] {'threshold': 0.8, 'since': 1755350576, 'seg_id': 'FR:mobile'}
2025-08-19 15:22:56,456 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:22:56,457 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:22:56,457 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:22:56,464 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:22:56,468 - sqlalchemy.engine.Engine - INFO - [generated in 0.00590s] {'updated_at': 1755609776, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 15:22:56,470 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:22:56,476 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:22:56,478 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:22:56,479 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:22:56,486 - sqlalchemy.engine.Engine - INFO - [cached since 0.06146s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755350576, 'status_1': 'approved'}
2025-08-19 15:22:56,486 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:22:56,489 - sqlalchemy.engine.Engine - INFO - [cached since 0.04712s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755350576, 'valid_final_1': 1}
2025-08-19 15:22:56,490 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:22:56,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:22:56,494 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:22:56,494 - sqlalchemy.engine.Engine - INFO - [cached since 0.04267s ago] {'threshold': 0.8, 'since': 1755350576, 'seg_id': 'FR:desktop'}
2025-08-19 15:22:56,494 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:22:56,502 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:22:56,503 - sqlalchemy.engine.Engine - INFO - [cached since 0.04527s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:22:56,504 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:22:56,506 - sqlalchemy.engine.Engine - INFO - [cached since 0.04331s ago] {'updated_at': 1755609776, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 15:22:56,506 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:22:56,506 - __main__ - INFO - DB session closed
2025-08-19 15:22:56,506 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:22:56 (took 0.09s)
2025-08-19 15:25:08,057 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 15:25:08,059 - __main__ - INFO - Initializing database...
2025-08-19 15:25:08,199 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 15:25:08,202 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:25:08,204 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 15:25:08,204 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:25:08,206 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 15:25:08,206 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:25:08,209 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:25:08,219 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:25:08,219 - sqlalchemy.engine.Engine - INFO - [generated in 0.00127s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:25:08,227 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:25:08,227 - sqlalchemy.engine.Engine - INFO - [cached since 0.008642s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:25:08,234 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:25:08,234 - sqlalchemy.engine.Engine - INFO - [cached since 0.01551s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:25:08,234 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:25:08,238 - sqlalchemy.engine.Engine - INFO - [cached since 0.01817s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:25:08,240 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:25:08,240 - sqlalchemy.engine.Engine - INFO - [cached since 0.021s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:25:08,243 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:25:08,243 - sqlalchemy.engine.Engine - INFO - [cached since 0.02389s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:25:08,246 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:25:08,248 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 15:25:08,248 - __main__ - INFO - Ensuring default segments exist
2025-08-19 15:25:08,285 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:25:08,292 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:25:08,292 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:25:08,298 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:25:08,302 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:25:08,302 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:25:08,302 - sqlalchemy.engine.Engine - INFO - [cached since 0.01243s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:25:08,306 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:25:08,306 - __main__ - INFO - Default segments ensured
2025-08-19 15:25:08,306 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 15:25:08,306 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:25:08,306 - __main__ - INFO - Fetching all segments
2025-08-19 15:25:08,311 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:25:08,313 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:25:08,317 - sqlalchemy.engine.Engine - INFO - [generated in 0.00457s] {}
2025-08-19 15:25:08,318 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:25:08,325 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:25:08,325 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755350708, 'status_1': 'approved'}
2025-08-19 15:25:08,340 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:25:08,340 - sqlalchemy.engine.Engine - INFO - [generated in 0.00105s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755350708, 'valid_final_1': 1}
2025-08-19 15:25:08,343 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:25:08,346 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:25:08,350 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:25:08,350 - sqlalchemy.engine.Engine - INFO - [generated in 0.00148s] {'threshold': 0.8, 'since': 1755350708, 'seg_id': 'FR:mobile'}
2025-08-19 15:25:08,354 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:25:08,356 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:25:08,356 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:25:08,362 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:25:08,364 - sqlalchemy.engine.Engine - INFO - [generated in 0.00264s] {'updated_at': 1755609908, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 15:25:08,366 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:25:08,372 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:25:08,375 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:25:08,377 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:25:08,384 - sqlalchemy.engine.Engine - INFO - [cached since 0.05894s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755350708, 'status_1': 'approved'}
2025-08-19 15:25:08,385 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:25:08,385 - sqlalchemy.engine.Engine - INFO - [cached since 0.04772s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755350708, 'valid_final_1': 1}
2025-08-19 15:25:08,389 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:25:08,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:25:08,393 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:25:08,394 - sqlalchemy.engine.Engine - INFO - [cached since 0.04446s ago] {'threshold': 0.8, 'since': 1755350708, 'seg_id': 'FR:desktop'}
2025-08-19 15:25:08,396 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:25:08,400 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:25:08,406 - sqlalchemy.engine.Engine - INFO - [cached since 0.0511s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:25:08,422 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:25:08,424 - sqlalchemy.engine.Engine - INFO - [cached since 0.06167s ago] {'updated_at': 1755609908, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 15:25:08,426 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:25:08,426 - __main__ - INFO - DB session closed
2025-08-19 15:25:08,428 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:25:08 (took 0.12s)
2025-08-19 15:29:35,068 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 15:29:35,071 - __main__ - INFO - Initializing database...
2025-08-19 15:29:35,208 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 15:29:35,214 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:29:35,227 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 15:29:35,228 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:29:35,234 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 15:29:35,234 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:29:35,237 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:29:35,242 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:29:35,244 - sqlalchemy.engine.Engine - INFO - [generated in 0.00095s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:29:35,254 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:29:35,255 - sqlalchemy.engine.Engine - INFO - [cached since 0.01095s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:29:35,257 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:29:35,257 - sqlalchemy.engine.Engine - INFO - [cached since 0.01392s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:29:35,257 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:29:35,261 - sqlalchemy.engine.Engine - INFO - [cached since 0.01701s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:29:35,264 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:29:35,267 - sqlalchemy.engine.Engine - INFO - [cached since 0.02348s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:29:35,269 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:29:35,270 - sqlalchemy.engine.Engine - INFO - [cached since 0.02692s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:29:35,270 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:29:35,273 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 15:29:35,273 - __main__ - INFO - Ensuring default segments exist
2025-08-19 15:29:35,308 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:29:35,313 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:29:35,316 - sqlalchemy.engine.Engine - INFO - [generated in 0.00308s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:29:35,321 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:29:35,321 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:29:35,321 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:29:35,326 - sqlalchemy.engine.Engine - INFO - [cached since 0.01335s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:29:35,330 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:29:35,333 - __main__ - INFO - Default segments ensured
2025-08-19 15:29:35,333 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 15:29:35,335 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:29:35,336 - __main__ - INFO - Fetching all segments
2025-08-19 15:29:35,337 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:29:35,338 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:29:35,339 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] {}
2025-08-19 15:29:35,340 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:29:35,347 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:29:35,350 - sqlalchemy.engine.Engine - INFO - [generated in 0.00398s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755350975, 'status_1': 'approved'}
2025-08-19 15:29:35,368 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:29:35,370 - sqlalchemy.engine.Engine - INFO - [generated in 0.00152s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755350975, 'valid_final_1': 1}
2025-08-19 15:29:35,372 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:29:35,372 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:29:35,376 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:29:35,377 - sqlalchemy.engine.Engine - INFO - [generated in 0.00107s] {'threshold': 0.8, 'since': 1755350975, 'seg_id': 'FR:mobile'}
2025-08-19 15:29:35,385 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:29:35,389 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:29:35,389 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:29:35,395 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:29:35,408 - sqlalchemy.engine.Engine - INFO - [generated in 0.01457s] {'updated_at': 1755610175, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 15:29:35,416 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:29:35,419 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:29:35,421 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:29:35,423 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:29:35,436 - sqlalchemy.engine.Engine - INFO - [cached since 0.08846s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755350975, 'status_1': 'approved'}
2025-08-19 15:29:35,439 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:29:35,442 - sqlalchemy.engine.Engine - INFO - [cached since 0.07264s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755350975, 'valid_final_1': 1}
2025-08-19 15:29:35,444 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:29:35,451 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:29:35,451 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:29:35,453 - sqlalchemy.engine.Engine - INFO - [cached since 0.07809s ago] {'threshold': 0.8, 'since': 1755350975, 'seg_id': 'FR:desktop'}
2025-08-19 15:29:35,456 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:29:35,457 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:29:35,457 - sqlalchemy.engine.Engine - INFO - [cached since 0.0699s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:29:35,457 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:29:35,457 - sqlalchemy.engine.Engine - INFO - [cached since 0.06642s ago] {'updated_at': 1755610175, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 15:29:35,467 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:29:35,468 - __main__ - INFO - DB session closed
2025-08-19 15:29:35,468 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:29:35 (took 0.13s)
2025-08-19 15:31:11,878 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 15:31:11,882 - __main__ - INFO - Initializing database...
2025-08-19 15:31:12,066 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 15:31:12,068 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:31:12,072 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 15:31:12,072 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:31:12,075 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 15:31:12,081 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:31:12,084 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:31:12,091 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:31:12,094 - sqlalchemy.engine.Engine - INFO - [generated in 0.00373s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:31:12,101 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:31:12,103 - sqlalchemy.engine.Engine - INFO - [cached since 0.01227s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:31:12,106 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:31:12,107 - sqlalchemy.engine.Engine - INFO - [cached since 0.01589s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:31:12,110 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:31:12,114 - sqlalchemy.engine.Engine - INFO - [cached since 0.0233s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:31:12,117 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:31:12,117 - sqlalchemy.engine.Engine - INFO - [cached since 0.0267s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:31:12,120 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:31:12,121 - sqlalchemy.engine.Engine - INFO - [cached since 0.03031s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:31:12,124 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:31:12,126 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 15:31:12,127 - __main__ - INFO - Ensuring default segments exist
2025-08-19 15:31:12,170 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:31:12,173 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:31:12,175 - sqlalchemy.engine.Engine - INFO - [generated in 0.00113s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:31:12,184 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:31:12,186 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:31:12,188 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:31:12,188 - sqlalchemy.engine.Engine - INFO - [cached since 0.01471s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:31:12,191 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:31:12,193 - __main__ - INFO - Default segments ensured
2025-08-19 15:31:12,197 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 15:31:12,197 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:31:12,197 - __main__ - INFO - Fetching all segments
2025-08-19 15:31:12,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:31:12,200 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:31:12,201 - sqlalchemy.engine.Engine - INFO - [generated in 0.00092s] {}
2025-08-19 15:31:12,203 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:31:12,209 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:31:12,212 - sqlalchemy.engine.Engine - INFO - [generated in 0.00423s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755351072, 'status_1': 'approved'}
2025-08-19 15:31:12,232 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:31:12,232 - sqlalchemy.engine.Engine - INFO - [generated in 0.00116s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755351072, 'valid_final_1': 1}
2025-08-19 15:31:12,234 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:31:12,238 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:31:12,239 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:31:12,240 - sqlalchemy.engine.Engine - INFO - [generated in 0.00121s] {'threshold': 0.8, 'since': 1755351072, 'seg_id': 'FR:mobile'}
2025-08-19 15:31:12,249 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:31:12,252 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:31:12,253 - sqlalchemy.engine.Engine - INFO - [generated in 0.00138s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:31:12,259 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:31:12,270 - sqlalchemy.engine.Engine - INFO - [generated in 0.01184s] {'updated_at': 1755610272, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 15:31:12,273 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:31:12,281 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:31:12,285 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:31:12,285 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:31:12,287 - sqlalchemy.engine.Engine - INFO - [cached since 0.07967s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755351072, 'status_1': 'approved'}
2025-08-19 15:31:12,290 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:31:12,305 - sqlalchemy.engine.Engine - INFO - [cached since 0.07417s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755351072, 'valid_final_1': 1}
2025-08-19 15:31:12,310 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:31:12,315 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:31:12,315 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:31:12,317 - sqlalchemy.engine.Engine - INFO - [cached since 0.07868s ago] {'threshold': 0.8, 'since': 1755351072, 'seg_id': 'FR:desktop'}
2025-08-19 15:31:12,320 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:31:12,324 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:31:12,325 - sqlalchemy.engine.Engine - INFO - [cached since 0.07403s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:31:12,330 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:31:12,337 - sqlalchemy.engine.Engine - INFO - [cached since 0.07977s ago] {'updated_at': 1755610272, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 15:31:12,340 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:31:12,347 - __main__ - INFO - DB session closed
2025-08-19 15:31:12,350 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:31:12 (took 0.15s)
2025-08-19 15:32:52,886 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 15:32:52,886 - __main__ - INFO - Initializing database...
2025-08-19 15:32:53,026 - sqlalchemy.engine.Engine - INFO - select pg_catalog.version()
2025-08-19 15:32:53,027 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:32:53,031 - sqlalchemy.engine.Engine - INFO - select current_schema()
2025-08-19 15:32:53,031 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:32:53,031 - sqlalchemy.engine.Engine - INFO - show standard_conforming_strings
2025-08-19 15:32:53,035 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-08-19 15:32:53,036 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:32:53,046 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:32:53,049 - sqlalchemy.engine.Engine - INFO - [generated in 0.00370s] {'table_name': 'offers', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:32:53,057 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:32:53,065 - sqlalchemy.engine.Engine - INFO - [cached since 0.01925s ago] {'table_name': 'segments', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:32:53,067 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:32:53,068 - sqlalchemy.engine.Engine - INFO - [cached since 0.0229s ago] {'table_name': 'creators', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:32:53,070 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:32:53,070 - sqlalchemy.engine.Engine - INFO - [cached since 0.0263s ago] {'table_name': 'clicks', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:32:53,074 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:32:53,076 - sqlalchemy.engine.Engine - INFO - [cached since 0.03094s ago] {'table_name': 'conversions', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:32:53,083 - sqlalchemy.engine.Engine - INFO - SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-08-19 15:32:53,085 - sqlalchemy.engine.Engine - INFO - [cached since 0.03921s ago] {'table_name': 'payout_rates', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-08-19 15:32:53,087 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:32:53,089 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 15:32:53,090 - __main__ - INFO - Ensuring default segments exist
2025-08-19 15:32:53,136 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:32:53,141 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:32:53,142 - sqlalchemy.engine.Engine - INFO - [generated in 0.00148s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:32:53,152 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:32:53,155 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:32:53,157 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:32:53,165 - sqlalchemy.engine.Engine - INFO - [cached since 0.02455s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:32:53,167 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:32:53,169 - __main__ - INFO - Default segments ensured
2025-08-19 15:32:53,170 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 15:32:53,171 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:32:53,171 - __main__ - INFO - Fetching all segments
2025-08-19 15:32:53,173 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:32:53,173 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:32:53,175 - sqlalchemy.engine.Engine - INFO - [generated in 0.00105s] {}
2025-08-19 15:32:53,181 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:32:53,185 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:32:53,188 - sqlalchemy.engine.Engine - INFO - [generated in 0.00142s] {'coalesce_1': 0.0, 'segment_id_1': 'FR:mobile', 'ts_1': 1755351173, 'status_1': 'approved'}
2025-08-19 15:32:53,210 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:32:53,214 - sqlalchemy.engine.Engine - INFO - [generated in 0.00589s] {'segment_id_1': 'FR:mobile', 'ts_1': 1755351173, 'valid_final_1': 1}
2025-08-19 15:32:53,217 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:32:53,219 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:32:53,221 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:32:53,222 - sqlalchemy.engine.Engine - INFO - [generated in 0.00107s] {'threshold': 0.8, 'since': 1755351173, 'seg_id': 'FR:mobile'}
2025-08-19 15:32:53,224 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:32:53,227 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:32:53,232 - sqlalchemy.engine.Engine - INFO - [generated in 0.00489s] {'segment_id_1': 'FR:mobile', 'param_1': 1}
2025-08-19 15:32:53,239 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:32:53,241 - sqlalchemy.engine.Engine - INFO - [generated in 0.00178s] {'updated_at': 1755610373, 'payout_rates_segment_id': 'FR:mobile'}
2025-08-19 15:32:53,245 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:32:53,254 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:32:53,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:32:53,257 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), %(coalesce_1)s) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND conversions.status = %(status_1)s
2025-08-19 15:32:53,257 - sqlalchemy.engine.Engine - INFO - [cached since 0.07121s ago] {'coalesce_1': 0.0, 'segment_id_1': 'FR:desktop', 'ts_1': 1755351173, 'status_1': 'approved'}
2025-08-19 15:32:53,264 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = %(segment_id_1)s AND clicks.ts >= %(ts_1)s AND clicks.valid_final = %(valid_final_1)s) AS anon_1
2025-08-19 15:32:53,266 - sqlalchemy.engine.Engine - INFO - [cached since 0.05673s ago] {'segment_id_1': 'FR:desktop', 'ts_1': 1755351173, 'valid_final_1': 1}
2025-08-19 15:32:53,267 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:32:53,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:32:53,270 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= %(threshold)s THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= %(since)s AND segment_id = %(seg_id)s
            
2025-08-19 15:32:53,272 - sqlalchemy.engine.Engine - INFO - [cached since 0.05076s ago] {'threshold': 0.8, 'since': 1755351173, 'seg_id': 'FR:desktop'}
2025-08-19 15:32:53,273 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:32:53,273 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = %(segment_id_1)s 
 LIMIT %(param_1)s
2025-08-19 15:32:53,273 - sqlalchemy.engine.Engine - INFO - [cached since 0.04804s ago] {'segment_id_1': 'FR:desktop', 'param_1': 1}
2025-08-19 15:32:53,282 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=%(updated_at)s WHERE payout_rates.segment_id = %(payout_rates_segment_id)s
2025-08-19 15:32:53,284 - sqlalchemy.engine.Engine - INFO - [cached since 0.04543s ago] {'updated_at': 1755610373, 'payout_rates_segment_id': 'FR:desktop'}
2025-08-19 15:32:53,286 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:32:53,290 - __main__ - INFO - DB session closed
2025-08-19 15:32:53,292 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:32:53 (took 0.12s)
2025-08-19 15:41:11,621 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 15:41:11,621 - __main__ - INFO - Initializing database...
2025-08-19 15:41:11,638 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:41:11,643 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 15:41:11,647 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:41:11,654 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 15:41:11,667 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:41:11,669 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 15:41:11,670 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:41:11,672 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 15:41:11,677 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:41:11,680 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 15:41:11,681 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:41:11,684 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 15:41:11,684 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:41:11,686 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:41:11,686 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 15:41:11,688 - __main__ - INFO - Ensuring default segments exist
2025-08-19 15:41:11,784 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:41:11,802 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:41:11,805 - sqlalchemy.engine.Engine - INFO - [generated in 0.00222s] ('FR:mobile', 1, 0)
2025-08-19 15:41:11,878 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:41:11,894 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:41:11,907 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:41:11,914 - sqlalchemy.engine.Engine - INFO - [cached since 0.1107s ago] ('FR:desktop', 1, 0)
2025-08-19 15:41:11,917 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:41:11,918 - __main__ - INFO - Default segments ensured
2025-08-19 15:41:11,920 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 15:41:11,921 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:41:11,922 - __main__ - INFO - Fetching all segments
2025-08-19 15:41:11,923 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:41:11,929 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:41:11,948 - sqlalchemy.engine.Engine - INFO - [generated in 0.01889s] ()
2025-08-19 15:41:11,950 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:41:11,960 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 15:41:11,968 - sqlalchemy.engine.Engine - INFO - [generated in 0.00771s] (0.0, 'FR:desktop', 1755351671, 'approved')
2025-08-19 15:41:11,987 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 15:41:12,105 - sqlalchemy.engine.Engine - INFO - [generated in 0.11871s] ('FR:desktop', 1755351671, 1)
2025-08-19 15:41:12,206 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:41:12,248 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:41:12,251 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 15:41:12,253 - sqlalchemy.engine.Engine - INFO - [generated in 0.00268s] (0.8, 1755351672, 'FR:desktop')
2025-08-19 15:41:12,255 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:41:12,266 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:41:12,446 - sqlalchemy.engine.Engine - INFO - [generated in 0.18042s] ('FR:desktop', 1, 0)
2025-08-19 15:41:12,640 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 15:41:12,868 - sqlalchemy.engine.Engine - INFO - [generated in 0.22801s] (1755610872, 'FR:desktop')
2025-08-19 15:41:12,972 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:41:12,988 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:41:13,002 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:41:13,017 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 15:41:13,019 - sqlalchemy.engine.Engine - INFO - [cached since 1.059s ago] (0.0, 'FR:mobile', 1755351673, 'approved')
2025-08-19 15:41:13,022 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 15:41:13,022 - sqlalchemy.engine.Engine - INFO - [cached since 1.036s ago] ('FR:mobile', 1755351673, 1)
2025-08-19 15:41:13,027 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:41:13,031 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:41:13,050 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 15:41:13,055 - sqlalchemy.engine.Engine - INFO - [cached since 0.8061s ago] (0.8, 1755351673, 'FR:mobile')
2025-08-19 15:41:13,065 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:41:13,067 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:41:13,069 - sqlalchemy.engine.Engine - INFO - [cached since 0.8025s ago] ('FR:mobile', 1, 0)
2025-08-19 15:41:13,071 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 15:41:13,073 - sqlalchemy.engine.Engine - INFO - [cached since 0.4323s ago] (1755610873, 'FR:mobile')
2025-08-19 15:41:13,074 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:41:13,091 - __main__ - INFO - DB session closed
2025-08-19 15:41:13,104 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:41:13 (took 1.18s)
2025-08-19 15:44:21,302 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 15:44:21,304 - __main__ - INFO - Initializing database...
2025-08-19 15:44:21,312 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:44:21,320 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 15:44:21,324 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:44:21,338 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 15:44:21,339 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:44:21,341 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 15:44:21,341 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:44:21,342 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 15:44:21,342 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:44:21,345 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 15:44:21,346 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:44:21,352 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 15:44:21,353 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 15:44:21,354 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:44:21,354 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 15:44:21,356 - __main__ - INFO - Ensuring default segments exist
2025-08-19 15:44:21,433 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:44:21,444 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:44:21,445 - sqlalchemy.engine.Engine - INFO - [generated in 0.00179s] ('FR:mobile', 1, 0)
2025-08-19 15:44:21,453 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:44:21,454 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:44:21,457 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:44:21,457 - sqlalchemy.engine.Engine - INFO - [cached since 0.01427s ago] ('FR:desktop', 1, 0)
2025-08-19 15:44:21,460 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:44:21,460 - __main__ - INFO - Default segments ensured
2025-08-19 15:44:21,463 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 15:44:21,468 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:44:21,468 - __main__ - INFO - Fetching all segments
2025-08-19 15:44:21,470 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:44:21,471 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:44:21,472 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] ()
2025-08-19 15:44:21,472 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:44:21,480 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 15:44:21,483 - sqlalchemy.engine.Engine - INFO - [generated in 0.00288s] (0.0, 'FR:desktop', 1755351861, 'approved')
2025-08-19 15:44:21,494 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 15:44:21,496 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] ('FR:desktop', 1755351861, 1)
2025-08-19 15:44:21,503 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:44:21,505 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:44:21,505 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 15:44:21,508 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] (0.8, 1755351861, 'FR:desktop')
2025-08-19 15:44:21,510 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:44:21,511 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:44:21,516 - sqlalchemy.engine.Engine - INFO - [generated in 0.00316s] ('FR:desktop', 1, 0)
2025-08-19 15:44:21,522 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 15:44:21,522 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] (1755611061, 'FR:desktop')
2025-08-19 15:44:21,522 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:44:21,530 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:44:21,533 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:44:21,538 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 15:44:21,539 - sqlalchemy.engine.Engine - INFO - [cached since 0.05968s ago] (0.0, 'FR:mobile', 1755351861, 'approved')
2025-08-19 15:44:21,542 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 15:44:21,542 - sqlalchemy.engine.Engine - INFO - [cached since 0.0486s ago] ('FR:mobile', 1755351861, 1)
2025-08-19 15:44:21,545 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:44:21,549 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:44:21,551 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 15:44:21,553 - sqlalchemy.engine.Engine - INFO - [cached since 0.04558s ago] (0.8, 1755351861, 'FR:mobile')
2025-08-19 15:44:21,554 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:44:21,556 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:44:21,556 - sqlalchemy.engine.Engine - INFO - [cached since 0.04478s ago] ('FR:mobile', 1, 0)
2025-08-19 15:44:21,559 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 15:44:21,560 - sqlalchemy.engine.Engine - INFO - [cached since 0.0379s ago] (1755611061, 'FR:mobile')
2025-08-19 15:44:21,560 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:44:21,566 - __main__ - INFO - DB session closed
2025-08-19 15:44:21,566 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:44:21 (took 0.10s)
2025-08-19 15:54:21,468 - __main__ - INFO - Starting autopilot iteration
2025-08-19 15:54:21,468 - __main__ - INFO - Fetching all segments
2025-08-19 15:54:21,486 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:54:21,487 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 15:54:21,487 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ()
2025-08-19 15:54:21,491 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 15:54:21,494 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 15:54:21,495 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.0, 'FR:desktop', 1755352461, 'approved')
2025-08-19 15:54:21,501 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 15:54:21,501 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1755352461, 1)
2025-08-19 15:54:21,501 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:54:21,505 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:54:21,506 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 15:54:21,506 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755352461, 'FR:desktop')
2025-08-19 15:54:21,506 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 15:54:21,506 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:54:21,510 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1, 0)
2025-08-19 15:54:21,514 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 15:54:21,516 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755611661, 'FR:desktop')
2025-08-19 15:54:21,517 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:54:21,526 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 15:54:21,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:54:21,529 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 15:54:21,532 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.0, 'FR:mobile', 1755352461, 'approved')
2025-08-19 15:54:21,536 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 15:54:21,537 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:mobile', 1755352461, 1)
2025-08-19 15:54:21,537 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 15:54:21,539 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 15:54:21,540 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 15:54:21,540 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755352461, 'FR:mobile')
2025-08-19 15:54:21,542 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 15:54:21,545 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 15:54:21,546 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:mobile', 1, 0)
2025-08-19 15:54:21,551 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 15:54:21,551 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755611661, 'FR:mobile')
2025-08-19 15:54:21,551 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 15:54:21,557 - __main__ - INFO - DB session closed
2025-08-19 15:54:21,557 - __main__ - INFO - Payout rates updated @ 2025-08-19 15:54:21 (took 0.09s)
2025-08-19 16:11:12,650 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 16:11:12,650 - __main__ - INFO - Initializing database...
2025-08-19 16:11:12,655 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:11:12,657 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 16:11:12,659 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 16:11:12,659 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 16:11:12,664 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 16:11:12,666 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 16:11:12,672 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 16:11:12,677 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 16:11:12,679 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 16:11:12,681 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 16:11:12,682 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 16:11:12,682 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 16:11:12,682 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 16:11:12,686 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:11:12,686 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 16:11:12,686 - __main__ - INFO - Ensuring default segments exist
2025-08-19 16:11:12,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:11:12,746 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:11:12,748 - sqlalchemy.engine.Engine - INFO - [generated in 0.00203s] ('FR:mobile', 1, 0)
2025-08-19 16:11:12,752 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:11:12,753 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:11:12,753 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:11:12,756 - sqlalchemy.engine.Engine - INFO - [cached since 0.009951s ago] ('FR:desktop', 1, 0)
2025-08-19 16:11:12,761 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:11:12,763 - __main__ - INFO - Default segments ensured
2025-08-19 16:11:12,763 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 16:11:12,765 - __main__ - INFO - Starting autopilot iteration
2025-08-19 16:11:12,765 - __main__ - INFO - Fetching all segments
2025-08-19 16:11:12,766 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:11:12,766 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 16:11:12,769 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] ()
2025-08-19 16:11:12,769 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 16:11:12,779 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:11:12,785 - sqlalchemy.engine.Engine - INFO - [generated in 0.00543s] (0.0, 'FR:desktop', 1755353472, 'approved')
2025-08-19 16:11:12,801 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:11:12,801 - sqlalchemy.engine.Engine - INFO - [generated in 0.00143s] ('FR:desktop', 1755353472, 1)
2025-08-19 16:11:12,806 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:11:12,810 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:11:12,812 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:11:12,814 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] (0.8, 1755353472, 'FR:desktop')
2025-08-19 16:11:12,817 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 16:11:12,820 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:11:12,820 - sqlalchemy.engine.Engine - INFO - [generated in 0.00128s] ('FR:desktop', 1, 0)
2025-08-19 16:11:12,826 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:11:12,828 - sqlalchemy.engine.Engine - INFO - [generated in 0.00135s] (1755612672, 'FR:desktop')
2025-08-19 16:11:12,830 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:11:12,838 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 16:11:12,839 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:11:12,843 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:11:12,845 - sqlalchemy.engine.Engine - INFO - [cached since 0.06505s ago] (0.0, 'FR:mobile', 1755353472, 'approved')
2025-08-19 16:11:12,847 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:11:12,847 - sqlalchemy.engine.Engine - INFO - [cached since 0.04787s ago] ('FR:mobile', 1755353472, 1)
2025-08-19 16:11:12,850 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:11:12,850 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:11:12,853 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:11:12,854 - sqlalchemy.engine.Engine - INFO - [cached since 0.0407s ago] (0.8, 1755353472, 'FR:mobile')
2025-08-19 16:11:12,857 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 16:11:12,860 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:11:12,862 - sqlalchemy.engine.Engine - INFO - [cached since 0.04237s ago] ('FR:mobile', 1, 0)
2025-08-19 16:11:12,863 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:11:12,865 - sqlalchemy.engine.Engine - INFO - [cached since 0.03821s ago] (1755612672, 'FR:mobile')
2025-08-19 16:11:12,866 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:11:12,870 - __main__ - INFO - DB session closed
2025-08-19 16:11:12,870 - __main__ - INFO - Payout rates updated @ 2025-08-19 16:11:12 (took 0.11s)
2025-08-19 16:21:12,766 - __main__ - INFO - Starting autopilot iteration
2025-08-19 16:21:12,768 - __main__ - INFO - Fetching all segments
2025-08-19 16:21:12,779 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:21:12,780 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 16:21:12,781 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ()
2025-08-19 16:21:12,784 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 16:21:12,785 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:21:12,786 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.0, 'FR:desktop', 1755354072, 'approved')
2025-08-19 16:21:12,791 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:21:12,792 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1755354072, 1)
2025-08-19 16:21:12,794 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:21:12,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:21:12,796 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:21:12,797 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755354072, 'FR:desktop')
2025-08-19 16:21:12,799 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 16:21:12,801 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:21:12,801 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1, 0)
2025-08-19 16:21:12,804 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:21:12,805 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755613272, 'FR:desktop')
2025-08-19 16:21:12,806 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:21:12,812 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 16:21:12,814 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:21:12,816 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:21:12,816 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.0, 'FR:mobile', 1755354072, 'approved')
2025-08-19 16:21:12,818 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:21:12,820 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:mobile', 1755354072, 1)
2025-08-19 16:21:12,822 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:21:12,824 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:21:12,824 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:21:12,825 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755354072, 'FR:mobile')
2025-08-19 16:21:12,828 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 16:21:12,829 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:21:12,830 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:mobile', 1, 0)
2025-08-19 16:21:12,832 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:21:12,833 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755613272, 'FR:mobile')
2025-08-19 16:21:12,834 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:21:12,836 - __main__ - INFO - DB session closed
2025-08-19 16:21:12,837 - __main__ - INFO - Payout rates updated @ 2025-08-19 16:21:12 (took 0.07s)
2025-08-19 16:31:12,767 - __main__ - INFO - Starting autopilot iteration
2025-08-19 16:31:12,768 - __main__ - INFO - Fetching all segments
2025-08-19 16:31:12,785 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:31:12,788 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 16:31:12,790 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ()
2025-08-19 16:31:12,795 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 16:31:12,799 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:31:12,801 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:desktop', 1755354672, 'approved')
2025-08-19 16:31:12,805 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:31:12,809 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1755354672, 1)
2025-08-19 16:31:12,811 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:31:12,814 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:31:12,815 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:31:12,816 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755354672, 'FR:desktop')
2025-08-19 16:31:12,819 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 16:31:12,822 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:31:12,825 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1, 0)
2025-08-19 16:31:12,827 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:31:12,828 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755613872, 'FR:desktop')
2025-08-19 16:31:12,829 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:31:12,840 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 16:31:12,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:31:12,844 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:31:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:mobile', 1755354672, 'approved')
2025-08-19 16:31:12,849 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:31:12,850 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1755354672, 1)
2025-08-19 16:31:12,852 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:31:12,855 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:31:12,856 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:31:12,858 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755354672, 'FR:mobile')
2025-08-19 16:31:12,860 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 16:31:12,862 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:31:12,864 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1, 0)
2025-08-19 16:31:12,865 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:31:12,867 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755613872, 'FR:mobile')
2025-08-19 16:31:12,869 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:31:12,875 - __main__ - INFO - DB session closed
2025-08-19 16:31:12,876 - __main__ - INFO - Payout rates updated @ 2025-08-19 16:31:12 (took 0.11s)
2025-08-19 16:41:12,769 - __main__ - INFO - Starting autopilot iteration
2025-08-19 16:41:12,769 - __main__ - INFO - Fetching all segments
2025-08-19 16:41:12,790 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:41:12,792 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 16:41:12,792 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ()
2025-08-19 16:41:12,805 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 16:41:12,810 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:41:12,815 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.0, 'FR:desktop', 1755355272, 'approved')
2025-08-19 16:41:12,822 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:41:12,823 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:desktop', 1755355272, 1)
2025-08-19 16:41:12,825 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:41:12,827 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:41:12,830 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:41:12,831 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.8, 1755355272, 'FR:desktop')
2025-08-19 16:41:12,831 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 16:41:12,831 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:41:12,831 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:desktop', 1, 0)
2025-08-19 16:41:12,838 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:41:12,839 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (1755614472, 'FR:desktop')
2025-08-19 16:41:12,841 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:41:12,847 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 16:41:12,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:41:12,853 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:41:12,857 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.0, 'FR:mobile', 1755355272, 'approved')
2025-08-19 16:41:12,857 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:41:12,857 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:mobile', 1755355272, 1)
2025-08-19 16:41:12,857 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:41:12,862 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:41:12,862 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:41:12,863 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.8, 1755355272, 'FR:mobile')
2025-08-19 16:41:12,866 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 16:41:12,866 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:41:12,867 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:mobile', 1, 0)
2025-08-19 16:41:12,868 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:41:12,868 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (1755614472, 'FR:mobile')
2025-08-19 16:41:12,871 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:41:12,872 - __main__ - INFO - DB session closed
2025-08-19 16:41:12,872 - __main__ - INFO - Payout rates updated @ 2025-08-19 16:41:12 (took 0.10s)
2025-08-19 16:51:12,773 - __main__ - INFO - Starting autopilot iteration
2025-08-19 16:51:12,776 - __main__ - INFO - Fetching all segments
2025-08-19 16:51:12,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:51:12,796 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 16:51:12,796 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ()
2025-08-19 16:51:12,803 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 16:51:12,806 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:51:12,807 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.0, 'FR:desktop', 1755355872, 'approved')
2025-08-19 16:51:12,807 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:51:12,807 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:desktop', 1755355872, 1)
2025-08-19 16:51:12,807 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:51:12,813 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:51:12,813 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:51:12,815 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.8, 1755355872, 'FR:desktop')
2025-08-19 16:51:12,815 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 16:51:12,818 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:51:12,818 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:desktop', 1, 0)
2025-08-19 16:51:12,818 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:51:12,821 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (1755615072, 'FR:desktop')
2025-08-19 16:51:12,822 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:51:12,832 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 16:51:12,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:51:12,832 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 16:51:12,832 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.0, 'FR:mobile', 1755355872, 'approved')
2025-08-19 16:51:12,839 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 16:51:12,840 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:mobile', 1755355872, 1)
2025-08-19 16:51:12,840 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 16:51:12,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 16:51:12,842 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 16:51:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.8, 1755355872, 'FR:mobile')
2025-08-19 16:51:12,846 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 16:51:12,846 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 16:51:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:mobile', 1, 0)
2025-08-19 16:51:12,846 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 16:51:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (1755615072, 'FR:mobile')
2025-08-19 16:51:12,846 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 16:51:12,854 - __main__ - INFO - DB session closed
2025-08-19 16:51:12,856 - __main__ - INFO - Payout rates updated @ 2025-08-19 16:51:12 (took 0.08s)
2025-08-19 17:01:12,774 - __main__ - INFO - Starting autopilot iteration
2025-08-19 17:01:12,776 - __main__ - INFO - Fetching all segments
2025-08-19 17:01:12,792 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:01:12,797 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 17:01:12,797 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ()
2025-08-19 17:01:12,805 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 17:01:12,808 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:01:12,808 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.0, 'FR:desktop', 1755356472, 'approved')
2025-08-19 17:01:12,808 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:01:12,813 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:desktop', 1755356472, 1)
2025-08-19 17:01:12,816 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:01:12,816 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:01:12,816 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:01:12,818 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.8, 1755356472, 'FR:desktop')
2025-08-19 17:01:12,819 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 17:01:12,821 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:01:12,821 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:desktop', 1, 0)
2025-08-19 17:01:12,821 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:01:12,821 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (1755615672, 'FR:desktop')
2025-08-19 17:01:12,821 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:01:12,832 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 17:01:12,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:01:12,835 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:01:12,835 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.0, 'FR:mobile', 1755356472, 'approved')
2025-08-19 17:01:12,838 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:01:12,840 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:mobile', 1755356472, 1)
2025-08-19 17:01:12,841 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:01:12,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:01:12,842 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:01:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.8, 1755356472, 'FR:mobile')
2025-08-19 17:01:12,842 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 17:01:12,846 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:01:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:mobile', 1, 0)
2025-08-19 17:01:12,846 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:01:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (1755615672, 'FR:mobile')
2025-08-19 17:01:12,851 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:01:12,854 - __main__ - INFO - DB session closed
2025-08-19 17:01:12,854 - __main__ - INFO - Payout rates updated @ 2025-08-19 17:01:12 (took 0.08s)
2025-08-19 17:11:12,775 - __main__ - INFO - Starting autopilot iteration
2025-08-19 17:11:12,777 - __main__ - INFO - Fetching all segments
2025-08-19 17:11:12,789 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:11:12,791 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 17:11:12,791 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ()
2025-08-19 17:11:12,794 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 17:11:12,794 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:11:12,796 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (0.0, 'FR:desktop', 1755357072, 'approved')
2025-08-19 17:11:12,796 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:11:12,799 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ('FR:desktop', 1755357072, 1)
2025-08-19 17:11:12,799 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:11:12,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:11:12,803 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:11:12,803 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (0.8, 1755357072, 'FR:desktop')
2025-08-19 17:11:12,803 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 17:11:12,807 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:11:12,807 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ('FR:desktop', 1, 0)
2025-08-19 17:11:12,810 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:11:12,810 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (1755616272, 'FR:desktop')
2025-08-19 17:11:12,810 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:11:12,816 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 17:11:12,819 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:11:12,819 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:11:12,819 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (0.0, 'FR:mobile', 1755357072, 'approved')
2025-08-19 17:11:12,822 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:11:12,822 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ('FR:mobile', 1755357072, 1)
2025-08-19 17:11:12,822 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:11:12,827 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:11:12,827 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:11:12,827 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (0.8, 1755357072, 'FR:mobile')
2025-08-19 17:11:12,830 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 17:11:12,831 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:11:12,831 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ('FR:mobile', 1, 0)
2025-08-19 17:11:12,831 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:11:12,831 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (1755616272, 'FR:mobile')
2025-08-19 17:11:12,831 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:11:12,838 - __main__ - INFO - DB session closed
2025-08-19 17:11:12,839 - __main__ - INFO - Payout rates updated @ 2025-08-19 17:11:12 (took 0.06s)
2025-08-19 17:21:12,775 - __main__ - INFO - Starting autopilot iteration
2025-08-19 17:21:12,775 - __main__ - INFO - Fetching all segments
2025-08-19 17:21:12,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:21:12,793 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 17:21:12,793 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ()
2025-08-19 17:21:12,796 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 17:21:12,801 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:21:12,801 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (0.0, 'FR:desktop', 1755357672, 'approved')
2025-08-19 17:21:12,804 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:21:12,804 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ('FR:desktop', 1755357672, 1)
2025-08-19 17:21:12,807 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:21:12,807 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:21:12,807 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:21:12,807 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (0.8, 1755357672, 'FR:desktop')
2025-08-19 17:21:12,812 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 17:21:12,814 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:21:12,814 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ('FR:desktop', 1, 0)
2025-08-19 17:21:12,815 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:21:12,815 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (1755616872, 'FR:desktop')
2025-08-19 17:21:12,818 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:21:12,832 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 17:21:12,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:21:12,832 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:21:12,832 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (0.0, 'FR:mobile', 1755357672, 'approved')
2025-08-19 17:21:12,839 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:21:12,840 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ('FR:mobile', 1755357672, 1)
2025-08-19 17:21:12,842 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:21:12,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:21:12,843 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:21:12,845 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (0.8, 1755357672, 'FR:mobile')
2025-08-19 17:21:12,846 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 17:21:12,850 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:21:12,850 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ('FR:mobile', 1, 0)
2025-08-19 17:21:12,852 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:21:12,852 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (1755616872, 'FR:mobile')
2025-08-19 17:21:12,853 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:21:12,862 - __main__ - INFO - DB session closed
2025-08-19 17:21:12,862 - __main__ - INFO - Payout rates updated @ 2025-08-19 17:21:12 (took 0.09s)
2025-08-19 17:31:12,776 - __main__ - INFO - Starting autopilot iteration
2025-08-19 17:31:12,777 - __main__ - INFO - Fetching all segments
2025-08-19 17:31:12,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:31:12,803 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 17:31:12,806 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ()
2025-08-19 17:31:12,806 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 17:31:12,811 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:31:12,813 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (0.0, 'FR:desktop', 1755358272, 'approved')
2025-08-19 17:31:12,817 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:31:12,817 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ('FR:desktop', 1755358272, 1)
2025-08-19 17:31:12,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:31:12,820 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:31:12,822 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:31:12,823 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (0.8, 1755358272, 'FR:desktop')
2025-08-19 17:31:12,824 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 17:31:12,826 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:31:12,826 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ('FR:desktop', 1, 0)
2025-08-19 17:31:12,827 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:31:12,828 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (1755617472, 'FR:desktop')
2025-08-19 17:31:12,828 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:31:12,837 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 17:31:12,839 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:31:12,840 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:31:12,840 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (0.0, 'FR:mobile', 1755358272, 'approved')
2025-08-19 17:31:12,843 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:31:12,844 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ('FR:mobile', 1755358272, 1)
2025-08-19 17:31:12,845 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:31:12,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:31:12,847 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:31:12,848 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (0.8, 1755358272, 'FR:mobile')
2025-08-19 17:31:12,848 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 17:31:12,848 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:31:12,848 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ('FR:mobile', 1, 0)
2025-08-19 17:31:12,854 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:31:12,854 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (1755617472, 'FR:mobile')
2025-08-19 17:31:12,856 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:31:12,856 - __main__ - INFO - DB session closed
2025-08-19 17:31:12,856 - __main__ - INFO - Payout rates updated @ 2025-08-19 17:31:12 (took 0.08s)
2025-08-19 17:41:12,781 - __main__ - INFO - Starting autopilot iteration
2025-08-19 17:41:12,783 - __main__ - INFO - Fetching all segments
2025-08-19 17:41:12,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:41:12,807 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 17:41:12,808 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ()
2025-08-19 17:41:12,812 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 17:41:12,813 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:41:12,814 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (0.0, 'FR:desktop', 1755358872, 'approved')
2025-08-19 17:41:12,816 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:41:12,816 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ('FR:desktop', 1755358872, 1)
2025-08-19 17:41:12,818 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:41:12,818 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:41:12,818 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:41:12,822 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (0.8, 1755358872, 'FR:desktop')
2025-08-19 17:41:12,822 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 17:41:12,822 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:41:12,822 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ('FR:desktop', 1, 0)
2025-08-19 17:41:12,827 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:41:12,827 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (1755618072, 'FR:desktop')
2025-08-19 17:41:12,827 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:41:12,833 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 17:41:12,833 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:41:12,838 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:41:12,839 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (0.0, 'FR:mobile', 1755358872, 'approved')
2025-08-19 17:41:12,841 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:41:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ('FR:mobile', 1755358872, 1)
2025-08-19 17:41:12,843 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:41:12,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:41:12,843 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:41:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (0.8, 1755358872, 'FR:mobile')
2025-08-19 17:41:12,847 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 17:41:12,847 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:41:12,847 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ('FR:mobile', 1, 0)
2025-08-19 17:41:12,847 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:41:12,852 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (1755618072, 'FR:mobile')
2025-08-19 17:41:12,854 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:41:12,857 - __main__ - INFO - DB session closed
2025-08-19 17:41:12,857 - __main__ - INFO - Payout rates updated @ 2025-08-19 17:41:12 (took 0.08s)
2025-08-19 17:51:12,784 - __main__ - INFO - Starting autopilot iteration
2025-08-19 17:51:12,784 - __main__ - INFO - Fetching all segments
2025-08-19 17:51:12,807 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:51:12,809 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 17:51:12,814 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ()
2025-08-19 17:51:12,820 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 17:51:12,823 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:51:12,825 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (0.0, 'FR:desktop', 1755359472, 'approved')
2025-08-19 17:51:12,829 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:51:12,831 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ('FR:desktop', 1755359472, 1)
2025-08-19 17:51:12,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:51:12,831 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:51:12,831 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:51:12,838 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (0.8, 1755359472, 'FR:desktop')
2025-08-19 17:51:12,840 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 17:51:12,842 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:51:12,843 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ('FR:desktop', 1, 0)
2025-08-19 17:51:12,844 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:51:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (1755618672, 'FR:desktop')
2025-08-19 17:51:12,848 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:51:12,853 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 17:51:12,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:51:12,856 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 17:51:12,857 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (0.0, 'FR:mobile', 1755359472, 'approved')
2025-08-19 17:51:12,857 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 17:51:12,857 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ('FR:mobile', 1755359472, 1)
2025-08-19 17:51:12,863 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 17:51:12,863 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 17:51:12,866 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 17:51:12,866 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (0.8, 1755359472, 'FR:mobile')
2025-08-19 17:51:12,868 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 17:51:12,868 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 17:51:12,868 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ('FR:mobile', 1, 0)
2025-08-19 17:51:12,871 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 17:51:12,871 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (1755618672, 'FR:mobile')
2025-08-19 17:51:12,873 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 17:51:12,873 - __main__ - INFO - DB session closed
2025-08-19 17:51:12,877 - __main__ - INFO - Payout rates updated @ 2025-08-19 17:51:12 (took 0.09s)
2025-08-19 18:01:12,785 - __main__ - INFO - Starting autopilot iteration
2025-08-19 18:01:12,785 - __main__ - INFO - Fetching all segments
2025-08-19 18:01:12,804 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:01:12,806 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 18:01:12,809 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ()
2025-08-19 18:01:12,814 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 18:01:12,815 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:01:12,815 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (0.0, 'FR:desktop', 1755360072, 'approved')
2025-08-19 18:01:12,818 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:01:12,820 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ('FR:desktop', 1755360072, 1)
2025-08-19 18:01:12,822 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:01:12,822 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:01:12,822 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:01:12,825 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (0.8, 1755360072, 'FR:desktop')
2025-08-19 18:01:12,825 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 18:01:12,827 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:01:12,827 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ('FR:desktop', 1, 0)
2025-08-19 18:01:12,830 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:01:12,830 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (1755619272, 'FR:desktop')
2025-08-19 18:01:12,832 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:01:12,839 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 18:01:12,840 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:01:12,841 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:01:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (0.0, 'FR:mobile', 1755360072, 'approved')
2025-08-19 18:01:12,845 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:01:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ('FR:mobile', 1755360072, 1)
2025-08-19 18:01:12,846 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:01:12,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:01:12,846 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:01:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (0.8, 1755360072, 'FR:mobile')
2025-08-19 18:01:12,851 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 18:01:12,853 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:01:12,853 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ('FR:mobile', 1, 0)
2025-08-19 18:01:12,853 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:01:12,856 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (1755619272, 'FR:mobile')
2025-08-19 18:01:12,857 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:01:12,859 - __main__ - INFO - DB session closed
2025-08-19 18:01:12,859 - __main__ - INFO - Payout rates updated @ 2025-08-19 18:01:12 (took 0.07s)
2025-08-19 18:11:12,789 - __main__ - INFO - Starting autopilot iteration
2025-08-19 18:11:12,791 - __main__ - INFO - Fetching all segments
2025-08-19 18:11:12,806 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:11:12,806 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 18:11:12,806 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ()
2025-08-19 18:11:12,813 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 18:11:12,813 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:11:12,815 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (0.0, 'FR:desktop', 1755360672, 'approved')
2025-08-19 18:11:12,818 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:11:12,818 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ('FR:desktop', 1755360672, 1)
2025-08-19 18:11:12,821 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:11:12,821 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:11:12,821 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:11:12,821 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (0.8, 1755360672, 'FR:desktop')
2025-08-19 18:11:12,826 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 18:11:12,827 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:11:12,827 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ('FR:desktop', 1, 0)
2025-08-19 18:11:12,830 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:11:12,830 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (1755619872, 'FR:desktop')
2025-08-19 18:11:12,831 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:11:12,840 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 18:11:12,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:11:12,842 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:11:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (0.0, 'FR:mobile', 1755360672, 'approved')
2025-08-19 18:11:12,847 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:11:12,847 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ('FR:mobile', 1755360672, 1)
2025-08-19 18:11:12,847 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:11:12,847 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:11:12,847 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:11:12,847 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (0.8, 1755360672, 'FR:mobile')
2025-08-19 18:11:12,853 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 18:11:12,853 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:11:12,856 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ('FR:mobile', 1, 0)
2025-08-19 18:11:12,856 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:11:12,856 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (1755619872, 'FR:mobile')
2025-08-19 18:11:12,856 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:11:12,856 - __main__ - INFO - DB session closed
2025-08-19 18:11:12,863 - __main__ - INFO - Payout rates updated @ 2025-08-19 18:11:12 (took 0.07s)
2025-08-19 18:21:12,791 - __main__ - INFO - Starting autopilot iteration
2025-08-19 18:21:12,793 - __main__ - INFO - Fetching all segments
2025-08-19 18:21:12,815 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:21:12,816 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 18:21:12,818 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] ()
2025-08-19 18:21:12,822 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 18:21:12,822 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:21:12,822 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] (0.0, 'FR:desktop', 1755361272, 'approved')
2025-08-19 18:21:12,828 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:21:12,830 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] ('FR:desktop', 1755361272, 1)
2025-08-19 18:21:12,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:21:12,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:21:12,834 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:21:12,835 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] (0.8, 1755361272, 'FR:desktop')
2025-08-19 18:21:12,835 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 18:21:12,838 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:21:12,839 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] ('FR:desktop', 1, 0)
2025-08-19 18:21:12,840 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:21:12,840 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] (1755620472, 'FR:desktop')
2025-08-19 18:21:12,842 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:21:12,850 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 18:21:12,850 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:21:12,850 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:21:12,853 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] (0.0, 'FR:mobile', 1755361272, 'approved')
2025-08-19 18:21:12,853 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:21:12,856 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] ('FR:mobile', 1755361272, 1)
2025-08-19 18:21:12,856 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:21:12,856 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:21:12,856 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:21:12,861 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] (0.8, 1755361272, 'FR:mobile')
2025-08-19 18:21:12,861 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 18:21:12,864 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:21:12,864 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] ('FR:mobile', 1, 0)
2025-08-19 18:21:12,866 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:21:12,866 - sqlalchemy.engine.Engine - INFO - [cached since 7800s ago] (1755620472, 'FR:mobile')
2025-08-19 18:21:12,866 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:21:12,871 - __main__ - INFO - DB session closed
2025-08-19 18:21:12,871 - __main__ - INFO - Payout rates updated @ 2025-08-19 18:21:12 (took 0.08s)
2025-08-19 18:31:12,793 - __main__ - INFO - Starting autopilot iteration
2025-08-19 18:31:12,796 - __main__ - INFO - Fetching all segments
2025-08-19 18:31:12,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:31:12,819 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 18:31:12,821 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] ()
2025-08-19 18:31:12,826 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 18:31:12,829 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:31:12,829 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] (0.0, 'FR:desktop', 1755361872, 'approved')
2025-08-19 18:31:12,831 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:31:12,831 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] ('FR:desktop', 1755361872, 1)
2025-08-19 18:31:12,835 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:31:12,838 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:31:12,838 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:31:12,839 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] (0.8, 1755361872, 'FR:desktop')
2025-08-19 18:31:12,840 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 18:31:12,842 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:31:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] ('FR:desktop', 1, 0)
2025-08-19 18:31:12,842 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:31:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] (1755621072, 'FR:desktop')
2025-08-19 18:31:12,846 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:31:12,853 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 18:31:12,853 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:31:12,853 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:31:12,856 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] (0.0, 'FR:mobile', 1755361872, 'approved')
2025-08-19 18:31:12,856 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:31:12,856 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] ('FR:mobile', 1755361872, 1)
2025-08-19 18:31:12,856 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:31:12,856 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:31:12,856 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:31:12,863 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] (0.8, 1755361872, 'FR:mobile')
2025-08-19 18:31:12,866 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 18:31:12,866 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:31:12,867 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] ('FR:mobile', 1, 0)
2025-08-19 18:31:12,868 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:31:12,868 - sqlalchemy.engine.Engine - INFO - [cached since 8400s ago] (1755621072, 'FR:mobile')
2025-08-19 18:31:12,868 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:31:12,872 - __main__ - INFO - DB session closed
2025-08-19 18:31:12,872 - __main__ - INFO - Payout rates updated @ 2025-08-19 18:31:12 (took 0.08s)
2025-08-19 18:41:12,797 - __main__ - INFO - Starting autopilot iteration
2025-08-19 18:41:12,800 - __main__ - INFO - Fetching all segments
2025-08-19 18:41:12,810 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:41:12,810 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 18:41:12,813 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] ()
2025-08-19 18:41:12,816 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 18:41:12,816 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:41:12,818 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] (0.0, 'FR:desktop', 1755362472, 'approved')
2025-08-19 18:41:12,818 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:41:12,822 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] ('FR:desktop', 1755362472, 1)
2025-08-19 18:41:12,822 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:41:12,824 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:41:12,824 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:41:12,827 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] (0.8, 1755362472, 'FR:desktop')
2025-08-19 18:41:12,827 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 18:41:12,829 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:41:12,829 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] ('FR:desktop', 1, 0)
2025-08-19 18:41:12,831 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:41:12,831 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] (1755621672, 'FR:desktop')
2025-08-19 18:41:12,831 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:41:12,840 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 18:41:12,840 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:41:12,842 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:41:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] (0.0, 'FR:mobile', 1755362472, 'approved')
2025-08-19 18:41:12,845 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:41:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] ('FR:mobile', 1755362472, 1)
2025-08-19 18:41:12,846 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:41:12,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:41:12,846 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:41:12,851 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] (0.8, 1755362472, 'FR:mobile')
2025-08-19 18:41:12,851 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 18:41:12,853 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:41:12,853 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] ('FR:mobile', 1, 0)
2025-08-19 18:41:12,856 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:41:12,856 - sqlalchemy.engine.Engine - INFO - [cached since 9000s ago] (1755621672, 'FR:mobile')
2025-08-19 18:41:12,856 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:41:12,861 - __main__ - INFO - DB session closed
2025-08-19 18:41:12,861 - __main__ - INFO - Payout rates updated @ 2025-08-19 18:41:12 (took 0.06s)
2025-08-19 18:51:12,800 - __main__ - INFO - Starting autopilot iteration
2025-08-19 18:51:12,800 - __main__ - INFO - Fetching all segments
2025-08-19 18:51:12,808 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:51:12,808 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 18:51:12,814 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] ()
2025-08-19 18:51:12,816 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 18:51:12,819 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:51:12,819 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] (0.0, 'FR:desktop', 1755363072, 'approved')
2025-08-19 18:51:12,821 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:51:12,821 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] ('FR:desktop', 1755363072, 1)
2025-08-19 18:51:12,824 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:51:12,826 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:51:12,827 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:51:12,828 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] (0.8, 1755363072, 'FR:desktop')
2025-08-19 18:51:12,830 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 18:51:12,831 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:51:12,831 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] ('FR:desktop', 1, 0)
2025-08-19 18:51:12,831 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:51:12,831 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] (1755622272, 'FR:desktop')
2025-08-19 18:51:12,831 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:51:12,841 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 18:51:12,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:51:12,842 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 18:51:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] (0.0, 'FR:mobile', 1755363072, 'approved')
2025-08-19 18:51:12,846 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 18:51:12,846 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] ('FR:mobile', 1755363072, 1)
2025-08-19 18:51:12,846 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 18:51:12,850 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 18:51:12,850 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 18:51:12,850 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] (0.8, 1755363072, 'FR:mobile')
2025-08-19 18:51:12,853 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 18:51:12,855 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 18:51:12,856 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] ('FR:mobile', 1, 0)
2025-08-19 18:51:12,856 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 18:51:12,856 - sqlalchemy.engine.Engine - INFO - [cached since 9600s ago] (1755622272, 'FR:mobile')
2025-08-19 18:51:12,856 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 18:51:12,856 - __main__ - INFO - DB session closed
2025-08-19 18:51:12,863 - __main__ - INFO - Payout rates updated @ 2025-08-19 18:51:12 (took 0.06s)
2025-08-19 19:01:12,802 - __main__ - INFO - Starting autopilot iteration
2025-08-19 19:01:12,802 - __main__ - INFO - Fetching all segments
2025-08-19 19:01:12,811 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:01:12,811 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 19:01:12,813 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] ()
2025-08-19 19:01:12,817 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 19:01:12,818 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:01:12,818 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] (0.0, 'FR:desktop', 1755363672, 'approved')
2025-08-19 19:01:12,821 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:01:12,823 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] ('FR:desktop', 1755363672, 1)
2025-08-19 19:01:12,823 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:01:12,823 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:01:12,827 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:01:12,827 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] (0.8, 1755363672, 'FR:desktop')
2025-08-19 19:01:12,830 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 19:01:12,831 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:01:12,832 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] ('FR:desktop', 1, 0)
2025-08-19 19:01:12,832 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:01:12,834 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] (1755622872, 'FR:desktop')
2025-08-19 19:01:12,834 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:01:12,917 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 19:01:12,918 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:01:12,918 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:01:12,921 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] (0.0, 'FR:mobile', 1755363672, 'approved')
2025-08-19 19:01:12,924 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:01:12,924 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] ('FR:mobile', 1755363672, 1)
2025-08-19 19:01:12,927 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:01:12,927 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:01:12,930 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:01:12,932 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] (0.8, 1755363672, 'FR:mobile')
2025-08-19 19:01:12,933 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 19:01:12,933 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:01:12,933 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] ('FR:mobile', 1, 0)
2025-08-19 19:01:12,933 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:01:12,933 - sqlalchemy.engine.Engine - INFO - [cached since 1.02e+04s ago] (1755622872, 'FR:mobile')
2025-08-19 19:01:12,939 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:01:12,940 - __main__ - INFO - DB session closed
2025-08-19 19:01:12,942 - __main__ - INFO - Payout rates updated @ 2025-08-19 19:01:12 (took 0.14s)
2025-08-19 19:03:03,262 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 19:03:03,262 - __main__ - INFO - Initializing database...
2025-08-19 19:03:03,265 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:03:03,268 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 19:03:03,270 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 19:03:03,274 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 19:03:03,275 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 19:03:03,275 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 19:03:03,278 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 19:03:03,278 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 19:03:03,280 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 19:03:03,281 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 19:03:03,282 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 19:03:03,284 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 19:03:03,286 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 19:03:03,288 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:03:03,289 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 19:03:03,290 - __main__ - INFO - Ensuring default segments exist
2025-08-19 19:03:03,354 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:03:03,360 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:03:03,363 - sqlalchemy.engine.Engine - INFO - [generated in 0.00282s] ('FR:mobile', 1, 0)
2025-08-19 19:03:03,366 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:03:03,373 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:03:03,374 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:03:03,376 - sqlalchemy.engine.Engine - INFO - [cached since 0.01575s ago] ('FR:desktop', 1, 0)
2025-08-19 19:03:03,377 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:03:03,381 - __main__ - INFO - Default segments ensured
2025-08-19 19:03:03,382 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 19:03:03,387 - __main__ - INFO - Starting autopilot iteration
2025-08-19 19:03:03,388 - __main__ - INFO - Fetching all segments
2025-08-19 19:03:03,390 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:03:03,392 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 19:03:03,392 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] ()
2025-08-19 19:03:03,392 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 19:03:03,401 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:03:03,401 - sqlalchemy.engine.Engine - INFO - [generated in 0.00136s] (0.0, 'FR:desktop', 1755363783, 'approved')
2025-08-19 19:03:03,412 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:03:03,413 - sqlalchemy.engine.Engine - INFO - [generated in 0.00097s] ('FR:desktop', 1755363783, 1)
2025-08-19 19:03:03,415 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:03:03,418 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:03:03,420 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:03:03,420 - sqlalchemy.engine.Engine - INFO - [generated in 0.00091s] (0.8, 1755363783, 'FR:desktop')
2025-08-19 19:03:03,423 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 19:03:03,425 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:03:03,427 - sqlalchemy.engine.Engine - INFO - [generated in 0.00144s] ('FR:desktop', 1, 0)
2025-08-19 19:03:03,431 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:03:03,434 - sqlalchemy.engine.Engine - INFO - [generated in 0.00264s] (1755622983, 'FR:desktop')
2025-08-19 19:03:03,436 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:03:03,449 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 19:03:03,451 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:03:03,453 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:03:03,453 - sqlalchemy.engine.Engine - INFO - [cached since 0.05373s ago] (0.0, 'FR:mobile', 1755363783, 'approved')
2025-08-19 19:03:03,457 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:03:03,457 - sqlalchemy.engine.Engine - INFO - [cached since 0.04618s ago] ('FR:mobile', 1755363783, 1)
2025-08-19 19:03:03,461 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:03:03,462 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:03:03,464 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:03:03,467 - sqlalchemy.engine.Engine - INFO - [cached since 0.0486s ago] (0.8, 1755363783, 'FR:mobile')
2025-08-19 19:03:03,471 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 19:03:03,473 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:03:03,473 - sqlalchemy.engine.Engine - INFO - [cached since 0.048s ago] ('FR:mobile', 1, 0)
2025-08-19 19:03:03,474 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:03:03,476 - sqlalchemy.engine.Engine - INFO - [cached since 0.04529s ago] (1755622983, 'FR:mobile')
2025-08-19 19:03:03,478 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:03:03,481 - __main__ - INFO - DB session closed
2025-08-19 19:03:03,482 - __main__ - INFO - Payout rates updated @ 2025-08-19 19:03:03 (took 0.09s)
2025-08-19 19:13:03,389 - __main__ - INFO - Starting autopilot iteration
2025-08-19 19:13:03,389 - __main__ - INFO - Fetching all segments
2025-08-19 19:13:03,473 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:13:03,473 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 19:13:03,477 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ()
2025-08-19 19:13:03,482 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 19:13:03,483 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:13:03,483 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.0, 'FR:desktop', 1755364383, 'approved')
2025-08-19 19:13:03,488 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:13:03,488 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:desktop', 1755364383, 1)
2025-08-19 19:13:03,490 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:13:03,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:13:03,493 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:13:03,493 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.8, 1755364383, 'FR:desktop')
2025-08-19 19:13:03,493 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 19:13:03,496 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:13:03,496 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:desktop', 1, 0)
2025-08-19 19:13:03,500 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:13:03,500 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (1755623583, 'FR:desktop')
2025-08-19 19:13:03,500 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:13:03,543 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 19:13:03,546 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:13:03,548 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:13:03,550 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.0, 'FR:mobile', 1755364383, 'approved')
2025-08-19 19:13:03,553 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:13:03,554 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:mobile', 1755364383, 1)
2025-08-19 19:13:03,556 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:13:03,557 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:13:03,558 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:13:03,559 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.8, 1755364383, 'FR:mobile')
2025-08-19 19:13:03,561 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 19:13:03,562 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:13:03,563 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:mobile', 1, 0)
2025-08-19 19:13:03,565 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:13:03,566 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (1755623583, 'FR:mobile')
2025-08-19 19:13:03,567 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:13:03,570 - __main__ - INFO - DB session closed
2025-08-19 19:13:03,570 - __main__ - INFO - Payout rates updated @ 2025-08-19 19:13:03 (took 0.18s)
2025-08-19 19:23:03,392 - __main__ - INFO - Starting autopilot iteration
2025-08-19 19:23:03,393 - __main__ - INFO - Fetching all segments
2025-08-19 19:23:03,406 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:23:03,406 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 19:23:03,411 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ()
2025-08-19 19:23:03,413 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 19:23:03,416 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:23:03,416 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:desktop', 1755364983, 'approved')
2025-08-19 19:23:03,420 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:23:03,420 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1755364983, 1)
2025-08-19 19:23:03,422 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:23:03,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:23:03,422 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:23:03,422 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755364983, 'FR:desktop')
2025-08-19 19:23:03,427 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 19:23:03,427 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:23:03,427 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1, 0)
2025-08-19 19:23:03,430 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:23:03,431 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755624183, 'FR:desktop')
2025-08-19 19:23:03,432 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:23:03,442 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 19:23:03,442 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:23:03,442 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:23:03,442 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:mobile', 1755364983, 'approved')
2025-08-19 19:23:03,447 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:23:03,447 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1755364983, 1)
2025-08-19 19:23:03,447 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:23:03,447 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:23:03,453 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:23:03,453 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755364983, 'FR:mobile')
2025-08-19 19:23:03,453 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 19:23:03,456 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:23:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1, 0)
2025-08-19 19:23:03,456 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:23:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755624183, 'FR:mobile')
2025-08-19 19:23:03,456 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:23:03,464 - __main__ - INFO - DB session closed
2025-08-19 19:23:03,464 - __main__ - INFO - Payout rates updated @ 2025-08-19 19:23:03 (took 0.07s)
2025-08-19 19:33:03,392 - __main__ - INFO - Starting autopilot iteration
2025-08-19 19:33:03,393 - __main__ - INFO - Fetching all segments
2025-08-19 19:33:03,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:33:03,418 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 19:33:03,419 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ()
2025-08-19 19:33:03,425 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 19:33:03,427 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:33:03,427 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.0, 'FR:desktop', 1755365583, 'approved')
2025-08-19 19:33:03,431 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:33:03,433 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:desktop', 1755365583, 1)
2025-08-19 19:33:03,435 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:33:03,437 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:33:03,438 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:33:03,440 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.8, 1755365583, 'FR:desktop')
2025-08-19 19:33:03,442 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 19:33:03,442 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:33:03,444 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:desktop', 1, 0)
2025-08-19 19:33:03,446 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:33:03,446 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (1755624783, 'FR:desktop')
2025-08-19 19:33:03,448 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:33:03,453 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 19:33:03,456 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:33:03,458 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:33:03,458 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.0, 'FR:mobile', 1755365583, 'approved')
2025-08-19 19:33:03,464 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:33:03,464 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:mobile', 1755365583, 1)
2025-08-19 19:33:03,467 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:33:03,468 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:33:03,469 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:33:03,469 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.8, 1755365583, 'FR:mobile')
2025-08-19 19:33:03,472 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 19:33:03,474 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:33:03,474 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:mobile', 1, 0)
2025-08-19 19:33:03,476 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:33:03,477 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (1755624783, 'FR:mobile')
2025-08-19 19:33:03,478 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:33:03,482 - __main__ - INFO - DB session closed
2025-08-19 19:33:03,483 - __main__ - INFO - Payout rates updated @ 2025-08-19 19:33:03 (took 0.09s)
2025-08-19 19:43:03,394 - __main__ - INFO - Starting autopilot iteration
2025-08-19 19:43:03,397 - __main__ - INFO - Fetching all segments
2025-08-19 19:43:03,414 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:43:03,414 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 19:43:03,416 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ()
2025-08-19 19:43:03,419 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 19:43:03,419 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:43:03,419 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.0, 'FR:desktop', 1755366183, 'approved')
2025-08-19 19:43:03,422 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:43:03,424 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:desktop', 1755366183, 1)
2025-08-19 19:43:03,427 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:43:03,429 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:43:03,430 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:43:03,431 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.8, 1755366183, 'FR:desktop')
2025-08-19 19:43:03,432 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 19:43:03,434 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:43:03,434 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:desktop', 1, 0)
2025-08-19 19:43:03,436 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:43:03,436 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (1755625383, 'FR:desktop')
2025-08-19 19:43:03,438 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:43:03,449 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 19:43:03,450 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:43:03,451 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:43:03,452 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.0, 'FR:mobile', 1755366183, 'approved')
2025-08-19 19:43:03,454 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:43:03,454 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:mobile', 1755366183, 1)
2025-08-19 19:43:03,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:43:03,457 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:43:03,458 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:43:03,459 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.8, 1755366183, 'FR:mobile')
2025-08-19 19:43:03,460 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 19:43:03,462 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:43:03,463 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:mobile', 1, 0)
2025-08-19 19:43:03,463 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:43:03,466 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (1755625383, 'FR:mobile')
2025-08-19 19:43:03,466 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:43:03,468 - __main__ - INFO - DB session closed
2025-08-19 19:43:03,468 - __main__ - INFO - Payout rates updated @ 2025-08-19 19:43:03 (took 0.08s)
2025-08-19 19:53:03,394 - __main__ - INFO - Starting autopilot iteration
2025-08-19 19:53:03,399 - __main__ - INFO - Fetching all segments
2025-08-19 19:53:03,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:53:03,417 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 19:53:03,419 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ()
2025-08-19 19:53:03,422 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 19:53:03,424 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:53:03,425 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.0, 'FR:desktop', 1755366783, 'approved')
2025-08-19 19:53:03,427 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:53:03,428 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:desktop', 1755366783, 1)
2025-08-19 19:53:03,431 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:53:03,432 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:53:03,433 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:53:03,433 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.8, 1755366783, 'FR:desktop')
2025-08-19 19:53:03,435 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 19:53:03,437 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:53:03,437 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:desktop', 1, 0)
2025-08-19 19:53:03,439 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:53:03,439 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (1755625983, 'FR:desktop')
2025-08-19 19:53:03,440 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:53:03,446 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 19:53:03,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:53:03,446 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 19:53:03,446 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.0, 'FR:mobile', 1755366783, 'approved')
2025-08-19 19:53:03,453 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 19:53:03,454 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:mobile', 1755366783, 1)
2025-08-19 19:53:03,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 19:53:03,456 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 19:53:03,456 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 19:53:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.8, 1755366783, 'FR:mobile')
2025-08-19 19:53:03,456 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 19:53:03,461 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 19:53:03,461 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:mobile', 1, 0)
2025-08-19 19:53:03,464 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 19:53:03,464 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (1755625983, 'FR:mobile')
2025-08-19 19:53:03,466 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 19:53:03,469 - __main__ - INFO - DB session closed
2025-08-19 19:53:03,469 - __main__ - INFO - Payout rates updated @ 2025-08-19 19:53:03 (took 0.07s)
2025-08-19 20:03:03,397 - __main__ - INFO - Starting autopilot iteration
2025-08-19 20:03:03,397 - __main__ - INFO - Fetching all segments
2025-08-19 20:03:03,417 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:03:03,418 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 20:03:03,418 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ()
2025-08-19 20:03:03,422 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 20:03:03,425 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:03:03,427 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (0.0, 'FR:desktop', 1755367383, 'approved')
2025-08-19 20:03:03,431 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:03:03,431 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ('FR:desktop', 1755367383, 1)
2025-08-19 20:03:03,431 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:03:03,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:03:03,436 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:03:03,436 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (0.8, 1755367383, 'FR:desktop')
2025-08-19 20:03:03,438 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 20:03:03,440 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:03:03,440 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ('FR:desktop', 1, 0)
2025-08-19 20:03:03,442 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:03:03,442 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (1755626583, 'FR:desktop')
2025-08-19 20:03:03,442 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:03:03,446 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 20:03:03,451 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:03:03,453 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:03:03,453 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (0.0, 'FR:mobile', 1755367383, 'approved')
2025-08-19 20:03:03,456 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:03:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ('FR:mobile', 1755367383, 1)
2025-08-19 20:03:03,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:03:03,456 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:03:03,456 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:03:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (0.8, 1755367383, 'FR:mobile')
2025-08-19 20:03:03,463 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 20:03:03,463 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:03:03,466 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] ('FR:mobile', 1, 0)
2025-08-19 20:03:03,467 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:03:03,468 - sqlalchemy.engine.Engine - INFO - [cached since 3600s ago] (1755626583, 'FR:mobile')
2025-08-19 20:03:03,468 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:03:03,472 - __main__ - INFO - DB session closed
2025-08-19 20:03:03,472 - __main__ - INFO - Payout rates updated @ 2025-08-19 20:03:03 (took 0.08s)
2025-08-19 20:13:03,399 - __main__ - INFO - Starting autopilot iteration
2025-08-19 20:13:03,399 - __main__ - INFO - Fetching all segments
2025-08-19 20:13:03,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:13:03,417 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 20:13:03,419 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ()
2025-08-19 20:13:03,423 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 20:13:03,423 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:13:03,423 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (0.0, 'FR:desktop', 1755367983, 'approved')
2025-08-19 20:13:03,429 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:13:03,431 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ('FR:desktop', 1755367983, 1)
2025-08-19 20:13:03,433 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:13:03,433 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:13:03,433 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:13:03,433 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (0.8, 1755367983, 'FR:desktop')
2025-08-19 20:13:03,433 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 20:13:03,439 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:13:03,439 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ('FR:desktop', 1, 0)
2025-08-19 20:13:03,440 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:13:03,440 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (1755627183, 'FR:desktop')
2025-08-19 20:13:03,443 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:13:03,448 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 20:13:03,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:13:03,448 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:13:03,453 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (0.0, 'FR:mobile', 1755367983, 'approved')
2025-08-19 20:13:03,454 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:13:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ('FR:mobile', 1755367983, 1)
2025-08-19 20:13:03,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:13:03,456 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:13:03,456 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:13:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (0.8, 1755367983, 'FR:mobile')
2025-08-19 20:13:03,456 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 20:13:03,463 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:13:03,465 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] ('FR:mobile', 1, 0)
2025-08-19 20:13:03,465 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:13:03,465 - sqlalchemy.engine.Engine - INFO - [cached since 4200s ago] (1755627183, 'FR:mobile')
2025-08-19 20:13:03,468 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:13:03,470 - __main__ - INFO - DB session closed
2025-08-19 20:13:03,470 - __main__ - INFO - Payout rates updated @ 2025-08-19 20:13:03 (took 0.07s)
2025-08-19 20:23:03,401 - __main__ - INFO - Starting autopilot iteration
2025-08-19 20:23:03,401 - __main__ - INFO - Fetching all segments
2025-08-19 20:23:03,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:23:03,422 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 20:23:03,428 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ()
2025-08-19 20:23:03,432 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 20:23:03,432 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:23:03,432 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (0.0, 'FR:desktop', 1755368583, 'approved')
2025-08-19 20:23:03,438 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:23:03,439 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ('FR:desktop', 1755368583, 1)
2025-08-19 20:23:03,440 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:23:03,442 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:23:03,443 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:23:03,443 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (0.8, 1755368583, 'FR:desktop')
2025-08-19 20:23:03,446 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 20:23:03,446 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:23:03,446 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ('FR:desktop', 1, 0)
2025-08-19 20:23:03,446 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:23:03,446 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (1755627783, 'FR:desktop')
2025-08-19 20:23:03,446 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:23:03,456 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 20:23:03,456 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:23:03,456 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:23:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (0.0, 'FR:mobile', 1755368583, 'approved')
2025-08-19 20:23:03,463 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:23:03,463 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ('FR:mobile', 1755368583, 1)
2025-08-19 20:23:03,465 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:23:03,467 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:23:03,468 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:23:03,469 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (0.8, 1755368583, 'FR:mobile')
2025-08-19 20:23:03,469 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 20:23:03,472 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:23:03,472 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] ('FR:mobile', 1, 0)
2025-08-19 20:23:03,474 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:23:03,474 - sqlalchemy.engine.Engine - INFO - [cached since 4800s ago] (1755627783, 'FR:mobile')
2025-08-19 20:23:03,477 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:23:03,480 - __main__ - INFO - DB session closed
2025-08-19 20:23:03,480 - __main__ - INFO - Payout rates updated @ 2025-08-19 20:23:03 (took 0.08s)
2025-08-19 20:33:03,402 - __main__ - INFO - Starting autopilot iteration
2025-08-19 20:33:03,403 - __main__ - INFO - Fetching all segments
2025-08-19 20:33:03,421 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:33:03,421 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 20:33:03,421 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ()
2025-08-19 20:33:03,425 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 20:33:03,427 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:33:03,427 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (0.0, 'FR:desktop', 1755369183, 'approved')
2025-08-19 20:33:03,431 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:33:03,431 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ('FR:desktop', 1755369183, 1)
2025-08-19 20:33:03,431 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:33:03,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:33:03,431 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:33:03,436 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (0.8, 1755369183, 'FR:desktop')
2025-08-19 20:33:03,438 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 20:33:03,440 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:33:03,440 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ('FR:desktop', 1, 0)
2025-08-19 20:33:03,442 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:33:03,443 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (1755628383, 'FR:desktop')
2025-08-19 20:33:03,443 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:33:03,456 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 20:33:03,456 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:33:03,462 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:33:03,462 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (0.0, 'FR:mobile', 1755369183, 'approved')
2025-08-19 20:33:03,464 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:33:03,465 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ('FR:mobile', 1755369183, 1)
2025-08-19 20:33:03,465 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:33:03,468 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:33:03,468 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:33:03,468 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (0.8, 1755369183, 'FR:mobile')
2025-08-19 20:33:03,471 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 20:33:03,471 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:33:03,471 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] ('FR:mobile', 1, 0)
2025-08-19 20:33:03,471 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:33:03,471 - sqlalchemy.engine.Engine - INFO - [cached since 5400s ago] (1755628383, 'FR:mobile')
2025-08-19 20:33:03,477 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:33:03,484 - __main__ - INFO - DB session closed
2025-08-19 20:33:03,484 - __main__ - INFO - Payout rates updated @ 2025-08-19 20:33:03 (took 0.08s)
2025-08-19 20:43:03,402 - __main__ - INFO - Starting autopilot iteration
2025-08-19 20:43:03,403 - __main__ - INFO - Fetching all segments
2025-08-19 20:43:03,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:43:03,418 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 20:43:03,418 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ()
2025-08-19 20:43:03,422 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 20:43:03,422 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:43:03,425 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (0.0, 'FR:desktop', 1755369783, 'approved')
2025-08-19 20:43:03,427 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:43:03,427 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ('FR:desktop', 1755369783, 1)
2025-08-19 20:43:03,431 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:43:03,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:43:03,431 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:43:03,431 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (0.8, 1755369783, 'FR:desktop')
2025-08-19 20:43:03,431 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 20:43:03,431 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:43:03,438 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ('FR:desktop', 1, 0)
2025-08-19 20:43:03,440 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:43:03,440 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (1755628983, 'FR:desktop')
2025-08-19 20:43:03,442 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:43:03,450 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 20:43:03,453 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:43:03,453 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:43:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (0.0, 'FR:mobile', 1755369783, 'approved')
2025-08-19 20:43:03,456 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:43:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ('FR:mobile', 1755369783, 1)
2025-08-19 20:43:03,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:43:03,461 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:43:03,461 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:43:03,463 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (0.8, 1755369783, 'FR:mobile')
2025-08-19 20:43:03,465 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 20:43:03,465 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:43:03,465 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] ('FR:mobile', 1, 0)
2025-08-19 20:43:03,468 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:43:03,468 - sqlalchemy.engine.Engine - INFO - [cached since 6000s ago] (1755628983, 'FR:mobile')
2025-08-19 20:43:03,468 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:43:03,472 - __main__ - INFO - DB session closed
2025-08-19 20:43:03,472 - __main__ - INFO - Payout rates updated @ 2025-08-19 20:43:03 (took 0.07s)
2025-08-19 20:53:03,407 - __main__ - INFO - Starting autopilot iteration
2025-08-19 20:53:03,407 - __main__ - INFO - Fetching all segments
2025-08-19 20:53:03,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:53:03,431 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 20:53:03,431 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ()
2025-08-19 20:53:03,439 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 20:53:03,440 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:53:03,440 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (0.0, 'FR:desktop', 1755370383, 'approved')
2025-08-19 20:53:03,444 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:53:03,444 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ('FR:desktop', 1755370383, 1)
2025-08-19 20:53:03,446 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:53:03,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:53:03,446 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:53:03,446 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (0.8, 1755370383, 'FR:desktop')
2025-08-19 20:53:03,446 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 20:53:03,453 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:53:03,453 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ('FR:desktop', 1, 0)
2025-08-19 20:53:03,455 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:53:03,456 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (1755629583, 'FR:desktop')
2025-08-19 20:53:03,456 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:53:03,466 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 20:53:03,468 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:53:03,468 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 20:53:03,470 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (0.0, 'FR:mobile', 1755370383, 'approved')
2025-08-19 20:53:03,471 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 20:53:03,471 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ('FR:mobile', 1755370383, 1)
2025-08-19 20:53:03,476 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 20:53:03,477 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 20:53:03,477 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 20:53:03,477 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (0.8, 1755370383, 'FR:mobile')
2025-08-19 20:53:03,481 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 20:53:03,481 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 20:53:03,481 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] ('FR:mobile', 1, 0)
2025-08-19 20:53:03,481 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 20:53:03,481 - sqlalchemy.engine.Engine - INFO - [cached since 6600s ago] (1755629583, 'FR:mobile')
2025-08-19 20:53:03,481 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 20:53:03,490 - __main__ - INFO - DB session closed
2025-08-19 20:53:03,490 - __main__ - INFO - Payout rates updated @ 2025-08-19 20:53:03 (took 0.08s)
2025-08-19 21:03:03,409 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:03:03,409 - __main__ - INFO - Fetching all segments
2025-08-19 21:03:03,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:03:03,431 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:03:03,435 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ()
2025-08-19 21:03:03,438 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:03:03,442 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:03:03,442 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (0.0, 'FR:desktop', 1755370983, 'approved')
2025-08-19 21:03:03,444 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:03:03,446 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ('FR:desktop', 1755370983, 1)
2025-08-19 21:03:03,446 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:03:03,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:03:03,446 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:03:03,446 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (0.8, 1755370983, 'FR:desktop')
2025-08-19 21:03:03,453 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:03:03,453 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:03:03,453 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ('FR:desktop', 1, 0)
2025-08-19 21:03:03,457 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:03:03,458 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (1755630183, 'FR:desktop')
2025-08-19 21:03:03,459 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:03:03,466 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:03:03,468 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:03:03,468 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:03:03,468 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (0.0, 'FR:mobile', 1755370983, 'approved')
2025-08-19 21:03:03,471 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:03:03,473 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ('FR:mobile', 1755370983, 1)
2025-08-19 21:03:03,473 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:03:03,473 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:03:03,477 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:03:03,477 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (0.8, 1755370983, 'FR:mobile')
2025-08-19 21:03:03,480 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:03:03,480 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:03:03,481 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] ('FR:mobile', 1, 0)
2025-08-19 21:03:03,483 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:03:03,483 - sqlalchemy.engine.Engine - INFO - [cached since 7200s ago] (1755630183, 'FR:mobile')
2025-08-19 21:03:03,483 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:03:03,488 - __main__ - INFO - DB session closed
2025-08-19 21:03:03,488 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:03:03 (took 0.08s)
2025-08-19 21:12:42,365 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 21:12:42,369 - __main__ - INFO - Initializing database...
2025-08-19 21:12:42,372 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:12:42,374 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 21:12:42,376 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:12:42,380 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 21:12:42,383 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:12:42,385 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 21:12:42,388 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:12:42,390 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 21:12:42,390 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:12:42,393 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 21:12:42,393 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:12:42,395 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 21:12:42,396 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:12:42,396 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:12:42,398 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 21:12:42,400 - __main__ - INFO - Ensuring default segments exist
2025-08-19 21:12:42,462 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:12:42,473 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:12:42,479 - sqlalchemy.engine.Engine - INFO - [generated in 0.00472s] ('FR:mobile', 1, 0)
2025-08-19 21:12:42,482 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:12:42,486 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:12:42,486 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:12:42,489 - sqlalchemy.engine.Engine - INFO - [cached since 0.01441s ago] ('FR:desktop', 1, 0)
2025-08-19 21:12:42,490 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:12:42,492 - __main__ - INFO - Default segments ensured
2025-08-19 21:12:42,492 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 21:12:42,494 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:12:42,494 - __main__ - INFO - Fetching all segments
2025-08-19 21:12:42,496 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:12:42,497 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:12:42,497 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] ()
2025-08-19 21:12:42,501 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:12:42,506 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:12:42,509 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] (0.0, 'FR:desktop', 1755371562, 'approved')
2025-08-19 21:12:42,518 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:12:42,519 - sqlalchemy.engine.Engine - INFO - [generated in 0.00122s] ('FR:desktop', 1755371562, 1)
2025-08-19 21:12:42,522 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:12:42,522 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:12:42,525 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:12:42,525 - sqlalchemy.engine.Engine - INFO - [generated in 0.00126s] (0.8, 1755371562, 'FR:desktop')
2025-08-19 21:12:42,529 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:12:42,532 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:12:42,534 - sqlalchemy.engine.Engine - INFO - [generated in 0.00263s] ('FR:desktop', 1, 0)
2025-08-19 21:12:42,539 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:12:42,541 - sqlalchemy.engine.Engine - INFO - [generated in 0.00156s] (1755630762, 'FR:desktop')
2025-08-19 21:12:42,542 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:12:42,548 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:12:42,552 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:12:42,553 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:12:42,555 - sqlalchemy.engine.Engine - INFO - [cached since 0.04767s ago] (0.0, 'FR:mobile', 1755371562, 'approved')
2025-08-19 21:12:42,557 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:12:42,557 - sqlalchemy.engine.Engine - INFO - [cached since 0.04069s ago] ('FR:mobile', 1755371562, 1)
2025-08-19 21:12:42,561 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:12:42,561 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:12:42,563 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:12:42,568 - sqlalchemy.engine.Engine - INFO - [cached since 0.04324s ago] (0.8, 1755371562, 'FR:mobile')
2025-08-19 21:12:42,570 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:12:42,570 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:12:42,572 - sqlalchemy.engine.Engine - INFO - [cached since 0.04091s ago] ('FR:mobile', 1, 0)
2025-08-19 21:12:42,574 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:12:42,574 - sqlalchemy.engine.Engine - INFO - [cached since 0.03684s ago] (1755630762, 'FR:mobile')
2025-08-19 21:12:42,577 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:12:42,583 - __main__ - INFO - DB session closed
2025-08-19 21:12:42,583 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:12:42 (took 0.09s)
2025-08-19 21:14:58,701 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 21:14:58,701 - __main__ - INFO - Initializing database...
2025-08-19 21:14:58,705 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:14:58,707 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 21:14:58,709 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:14:58,713 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 21:14:58,714 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:14:58,715 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 21:14:58,715 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:14:58,715 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 21:14:58,718 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:14:58,720 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 21:14:58,721 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:14:58,722 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 21:14:58,723 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:14:58,723 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:14:58,725 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 21:14:58,726 - __main__ - INFO - Ensuring default segments exist
2025-08-19 21:14:58,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:14:58,793 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:14:58,793 - sqlalchemy.engine.Engine - INFO - [generated in 0.00175s] ('FR:mobile', 1, 0)
2025-08-19 21:14:58,798 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:14:58,800 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:14:58,804 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:14:58,804 - sqlalchemy.engine.Engine - INFO - [cached since 0.01201s ago] ('FR:desktop', 1, 0)
2025-08-19 21:14:58,808 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:14:58,810 - __main__ - INFO - Default segments ensured
2025-08-19 21:14:58,810 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 21:14:58,812 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:14:58,814 - __main__ - INFO - Fetching all segments
2025-08-19 21:14:58,815 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:14:58,815 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:14:58,815 - sqlalchemy.engine.Engine - INFO - [generated in 0.00132s] ()
2025-08-19 21:14:58,818 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:14:58,824 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:14:58,827 - sqlalchemy.engine.Engine - INFO - [generated in 0.00208s] (0.0, 'FR:desktop', 1755371698, 'approved')
2025-08-19 21:14:58,839 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:14:58,841 - sqlalchemy.engine.Engine - INFO - [generated in 0.00138s] ('FR:desktop', 1755371698, 1)
2025-08-19 21:14:58,842 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:14:58,848 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:14:58,849 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:14:58,851 - sqlalchemy.engine.Engine - INFO - [generated in 0.00175s] (0.8, 1755371698, 'FR:desktop')
2025-08-19 21:14:58,856 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:14:58,863 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:14:58,865 - sqlalchemy.engine.Engine - INFO - [generated in 0.00174s] ('FR:desktop', 1, 0)
2025-08-19 21:14:58,869 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:14:58,873 - sqlalchemy.engine.Engine - INFO - [generated in 0.00369s] (1755630898, 'FR:desktop')
2025-08-19 21:14:58,873 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:14:58,881 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:14:58,881 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:14:58,883 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:14:58,885 - sqlalchemy.engine.Engine - INFO - [cached since 0.05978s ago] (0.0, 'FR:mobile', 1755371698, 'approved')
2025-08-19 21:14:58,889 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:14:58,890 - sqlalchemy.engine.Engine - INFO - [cached since 0.05055s ago] ('FR:mobile', 1755371698, 1)
2025-08-19 21:14:58,893 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:14:58,893 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:14:58,893 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:14:58,895 - sqlalchemy.engine.Engine - INFO - [cached since 0.04537s ago] (0.8, 1755371698, 'FR:mobile')
2025-08-19 21:14:58,896 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:14:58,896 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:14:58,896 - sqlalchemy.engine.Engine - INFO - [cached since 0.03625s ago] ('FR:mobile', 1, 0)
2025-08-19 21:14:58,900 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:14:58,903 - sqlalchemy.engine.Engine - INFO - [cached since 0.03405s ago] (1755630898, 'FR:mobile')
2025-08-19 21:14:58,903 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:14:58,906 - __main__ - INFO - DB session closed
2025-08-19 21:14:58,906 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:14:58 (took 0.09s)
2025-08-19 21:16:26,109 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 21:16:26,109 - __main__ - INFO - Initializing database...
2025-08-19 21:16:26,113 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:16:26,115 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 21:16:26,117 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:16:26,122 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 21:16:26,126 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:16:26,127 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 21:16:26,128 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:16:26,128 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 21:16:26,130 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:16:26,131 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 21:16:26,132 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:16:26,132 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 21:16:26,134 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:16:26,134 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:16:26,136 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 21:16:26,136 - __main__ - INFO - Ensuring default segments exist
2025-08-19 21:16:26,206 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:16:26,213 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:16:26,214 - sqlalchemy.engine.Engine - INFO - [generated in 0.00147s] ('FR:mobile', 1, 0)
2025-08-19 21:16:26,218 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:16:26,220 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:16:26,224 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:16:26,229 - sqlalchemy.engine.Engine - INFO - [cached since 0.01549s ago] ('FR:desktop', 1, 0)
2025-08-19 21:16:26,233 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:16:26,233 - __main__ - INFO - Default segments ensured
2025-08-19 21:16:26,233 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 21:16:26,233 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:16:26,233 - __main__ - INFO - Fetching all segments
2025-08-19 21:16:26,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:16:26,242 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:16:26,245 - sqlalchemy.engine.Engine - INFO - [generated in 0.00180s] ()
2025-08-19 21:16:26,245 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:16:26,247 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:16:26,251 - sqlalchemy.engine.Engine - INFO - [generated in 0.00158s] (0.0, 'FR:desktop', 1755371786, 'approved')
2025-08-19 21:16:26,266 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:16:26,266 - sqlalchemy.engine.Engine - INFO - [generated in 0.00130s] ('FR:desktop', 1755371786, 1)
2025-08-19 21:16:26,268 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:16:26,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:16:26,272 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:16:26,273 - sqlalchemy.engine.Engine - INFO - [generated in 0.00233s] (0.8, 1755371786, 'FR:desktop')
2025-08-19 21:16:26,278 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:16:26,281 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:16:26,282 - sqlalchemy.engine.Engine - INFO - [generated in 0.00090s] ('FR:desktop', 1, 0)
2025-08-19 21:16:26,285 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:16:26,289 - sqlalchemy.engine.Engine - INFO - [generated in 0.00253s] (1755630986, 'FR:desktop')
2025-08-19 21:16:26,293 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:16:26,296 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:16:26,301 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:16:26,303 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:16:26,303 - sqlalchemy.engine.Engine - INFO - [cached since 0.05354s ago] (0.0, 'FR:mobile', 1755371786, 'approved')
2025-08-19 21:16:26,309 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:16:26,309 - sqlalchemy.engine.Engine - INFO - [cached since 0.04414s ago] ('FR:mobile', 1755371786, 1)
2025-08-19 21:16:26,311 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:16:26,314 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:16:26,314 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:16:26,316 - sqlalchemy.engine.Engine - INFO - [cached since 0.04326s ago] (0.8, 1755371786, 'FR:mobile')
2025-08-19 21:16:26,318 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:16:26,318 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:16:26,320 - sqlalchemy.engine.Engine - INFO - [cached since 0.039s ago] ('FR:mobile', 1, 0)
2025-08-19 21:16:26,322 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:16:26,324 - sqlalchemy.engine.Engine - INFO - [cached since 0.03739s ago] (1755630986, 'FR:mobile')
2025-08-19 21:16:26,325 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:16:26,329 - __main__ - INFO - DB session closed
2025-08-19 21:16:26,329 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:16:26 (took 0.10s)
2025-08-19 21:18:06,195 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 21:18:06,195 - __main__ - INFO - Initializing database...
2025-08-19 21:18:06,202 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:18:06,210 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 21:18:06,212 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:18:06,215 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 21:18:06,217 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:18:06,219 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 21:18:06,221 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:18:06,224 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 21:18:06,224 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:18:06,226 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 21:18:06,227 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:18:06,229 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 21:18:06,229 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:18:06,232 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:18:06,232 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 21:18:06,234 - __main__ - INFO - Ensuring default segments exist
2025-08-19 21:18:06,296 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:18:06,301 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:18:06,303 - sqlalchemy.engine.Engine - INFO - [generated in 0.00180s] ('FR:mobile', 1, 0)
2025-08-19 21:18:06,305 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:18:06,308 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:18:06,309 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:18:06,311 - sqlalchemy.engine.Engine - INFO - [cached since 0.01024s ago] ('FR:desktop', 1, 0)
2025-08-19 21:18:06,314 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:18:06,315 - __main__ - INFO - Default segments ensured
2025-08-19 21:18:06,315 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 21:18:06,315 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:18:06,315 - __main__ - INFO - Fetching all segments
2025-08-19 21:18:06,318 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:18:06,318 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:18:06,321 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] ()
2025-08-19 21:18:06,322 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:18:06,331 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:18:06,333 - sqlalchemy.engine.Engine - INFO - [generated in 0.00172s] (0.0, 'FR:desktop', 1755371886, 'approved')
2025-08-19 21:18:06,345 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:18:06,346 - sqlalchemy.engine.Engine - INFO - [generated in 0.00173s] ('FR:desktop', 1755371886, 1)
2025-08-19 21:18:06,348 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:18:06,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:18:06,353 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:18:06,354 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] (0.8, 1755371886, 'FR:desktop')
2025-08-19 21:18:06,356 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:18:06,361 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:18:06,363 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ('FR:desktop', 1, 0)
2025-08-19 21:18:06,367 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:18:06,368 - sqlalchemy.engine.Engine - INFO - [generated in 0.00153s] (1755631086, 'FR:desktop')
2025-08-19 21:18:06,369 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:18:06,379 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:18:06,380 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:18:06,383 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:18:06,383 - sqlalchemy.engine.Engine - INFO - [cached since 0.0515s ago] (0.0, 'FR:mobile', 1755371886, 'approved')
2025-08-19 21:18:06,386 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:18:06,386 - sqlalchemy.engine.Engine - INFO - [cached since 0.0421s ago] ('FR:mobile', 1755371886, 1)
2025-08-19 21:18:06,392 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:18:06,393 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:18:06,395 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:18:06,396 - sqlalchemy.engine.Engine - INFO - [cached since 0.04261s ago] (0.8, 1755371886, 'FR:mobile')
2025-08-19 21:18:06,398 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:18:06,399 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:18:06,399 - sqlalchemy.engine.Engine - INFO - [cached since 0.0384s ago] ('FR:mobile', 1, 0)
2025-08-19 21:18:06,401 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:18:06,403 - sqlalchemy.engine.Engine - INFO - [cached since 0.03655s ago] (1755631086, 'FR:mobile')
2025-08-19 21:18:06,405 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:18:06,407 - __main__ - INFO - DB session closed
2025-08-19 21:18:06,407 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:18:06 (took 0.09s)
2025-08-19 21:20:00,645 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 21:20:00,646 - __main__ - INFO - Initializing database...
2025-08-19 21:20:00,650 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:20:00,655 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 21:20:00,658 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:20:00,658 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 21:20:00,658 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:20:00,658 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 21:20:00,666 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:20:00,668 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 21:20:00,672 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:20:00,674 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 21:20:00,676 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:20:00,678 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 21:20:00,678 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:20:00,680 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:20:00,681 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 21:20:00,681 - __main__ - INFO - Ensuring default segments exist
2025-08-19 21:20:00,737 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:20:00,743 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:20:00,743 - sqlalchemy.engine.Engine - INFO - [generated in 0.00150s] ('FR:mobile', 1, 0)
2025-08-19 21:20:00,747 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:20:00,747 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:20:00,747 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:20:00,747 - sqlalchemy.engine.Engine - INFO - [cached since 0.007708s ago] ('FR:desktop', 1, 0)
2025-08-19 21:20:00,753 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:20:00,753 - __main__ - INFO - Default segments ensured
2025-08-19 21:20:00,756 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 21:20:00,756 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:20:00,757 - __main__ - INFO - Fetching all segments
2025-08-19 21:20:00,758 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:20:00,758 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:20:00,758 - sqlalchemy.engine.Engine - INFO - [generated in 0.00094s] ()
2025-08-19 21:20:00,758 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:20:00,766 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:20:00,766 - sqlalchemy.engine.Engine - INFO - [generated in 0.00077s] (0.0, 'FR:desktop', 1755372000, 'approved')
2025-08-19 21:20:00,772 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:20:00,777 - sqlalchemy.engine.Engine - INFO - [generated in 0.00152s] ('FR:desktop', 1755372000, 1)
2025-08-19 21:20:00,780 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:20:00,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:20:00,782 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:20:00,782 - sqlalchemy.engine.Engine - INFO - [generated in 0.00157s] (0.8, 1755372000, 'FR:desktop')
2025-08-19 21:20:00,790 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:20:00,793 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:20:00,794 - sqlalchemy.engine.Engine - INFO - [generated in 0.00116s] ('FR:desktop', 1, 0)
2025-08-19 21:20:00,802 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:20:00,805 - sqlalchemy.engine.Engine - INFO - [generated in 0.00252s] (1755631200, 'FR:desktop')
2025-08-19 21:20:00,806 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:20:00,812 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:20:00,815 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:20:00,815 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:20:00,815 - sqlalchemy.engine.Engine - INFO - [cached since 0.05104s ago] (0.0, 'FR:mobile', 1755372000, 'approved')
2025-08-19 21:20:00,818 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:20:00,821 - sqlalchemy.engine.Engine - INFO - [cached since 0.04682s ago] ('FR:mobile', 1755372000, 1)
2025-08-19 21:20:00,823 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:20:00,826 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:20:00,826 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:20:00,829 - sqlalchemy.engine.Engine - INFO - [cached since 0.04477s ago] (0.8, 1755372000, 'FR:mobile')
2025-08-19 21:20:00,833 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:20:00,833 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:20:00,833 - sqlalchemy.engine.Engine - INFO - [cached since 0.04077s ago] ('FR:mobile', 1, 0)
2025-08-19 21:20:00,836 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:20:00,839 - sqlalchemy.engine.Engine - INFO - [cached since 0.03573s ago] (1755631200, 'FR:mobile')
2025-08-19 21:20:00,841 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:20:00,842 - __main__ - INFO - DB session closed
2025-08-19 21:20:00,844 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:20:00 (took 0.09s)
2025-08-19 21:30:00,757 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:30:00,763 - __main__ - INFO - Fetching all segments
2025-08-19 21:30:00,765 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:30:00,767 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:30:00,773 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ()
2025-08-19 21:30:00,777 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:30:00,780 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:30:00,781 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.0, 'FR:desktop', 1755372600, 'approved')
2025-08-19 21:30:00,792 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:30:00,795 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1755372600, 1)
2025-08-19 21:30:00,797 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:30:00,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:30:00,799 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:30:00,804 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755372600, 'FR:desktop')
2025-08-19 21:30:00,809 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:30:00,809 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:30:00,809 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1, 0)
2025-08-19 21:30:00,809 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:30:00,815 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755631800, 'FR:desktop')
2025-08-19 21:30:00,822 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:30:00,838 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:30:00,840 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:30:00,843 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:30:00,843 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.0, 'FR:mobile', 1755372600, 'approved')
2025-08-19 21:30:00,846 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:30:00,846 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:mobile', 1755372600, 1)
2025-08-19 21:30:00,846 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:30:00,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:30:00,856 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:30:00,856 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.8, 1755372600, 'FR:mobile')
2025-08-19 21:30:00,859 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:30:00,859 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:30:00,862 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:mobile', 1, 0)
2025-08-19 21:30:00,863 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:30:00,865 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (1755631800, 'FR:mobile')
2025-08-19 21:30:00,867 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:30:00,873 - __main__ - INFO - DB session closed
2025-08-19 21:30:00,874 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:30:00 (took 0.12s)
2025-08-19 21:40:00,759 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:40:00,759 - __main__ - INFO - Fetching all segments
2025-08-19 21:40:00,789 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:00,791 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:40:00,795 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ()
2025-08-19 21:40:00,807 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:40:00,807 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:40:00,807 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:desktop', 1755373200, 'approved')
2025-08-19 21:40:00,817 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:40:00,818 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1755373200, 1)
2025-08-19 21:40:00,822 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:40:00,822 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:00,822 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:40:00,822 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755373200, 'FR:desktop')
2025-08-19 21:40:00,827 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:40:00,830 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:40:00,831 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1, 0)
2025-08-19 21:40:00,831 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:40:00,831 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755632400, 'FR:desktop')
2025-08-19 21:40:00,831 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:40:00,850 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:40:00,850 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:00,853 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:40:00,853 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:mobile', 1755373200, 'approved')
2025-08-19 21:40:00,856 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:40:00,856 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1755373200, 1)
2025-08-19 21:40:00,856 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:40:00,861 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:00,861 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:40:00,861 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755373200, 'FR:mobile')
2025-08-19 21:40:00,864 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:40:00,865 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:40:00,865 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1, 0)
2025-08-19 21:40:00,868 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:40:00,868 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755632400, 'FR:mobile')
2025-08-19 21:40:00,868 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:40:00,872 - __main__ - INFO - DB session closed
2025-08-19 21:40:00,872 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:40:00 (took 0.11s)
2025-08-19 21:40:13,832 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 21:40:13,832 - __main__ - INFO - Initializing database...
2025-08-19 21:40:13,838 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:13,844 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 21:40:13,844 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:40:13,865 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 21:40:13,865 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:40:13,869 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 21:40:13,869 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:40:13,872 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 21:40:13,872 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:40:13,872 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 21:40:13,872 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:40:13,872 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 21:40:13,877 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 21:40:13,877 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:40:13,877 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 21:40:13,879 - __main__ - INFO - Ensuring default segments exist
2025-08-19 21:40:13,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:13,936 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:40:13,936 - sqlalchemy.engine.Engine - INFO - [generated in 0.00135s] ('FR:mobile', 1, 0)
2025-08-19 21:40:13,940 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:40:13,943 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:13,943 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:40:13,943 - sqlalchemy.engine.Engine - INFO - [cached since 0.007747s ago] ('FR:desktop', 1, 0)
2025-08-19 21:40:13,946 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:40:13,947 - __main__ - INFO - Default segments ensured
2025-08-19 21:40:13,949 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 21:40:13,949 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:40:13,951 - __main__ - INFO - Fetching all segments
2025-08-19 21:40:13,951 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:13,954 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:40:13,954 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] ()
2025-08-19 21:40:13,954 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:40:13,960 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:40:13,960 - sqlalchemy.engine.Engine - INFO - [generated in 0.00082s] (0.0, 'FR:desktop', 1755373213, 'approved')
2025-08-19 21:40:13,972 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:40:13,972 - sqlalchemy.engine.Engine - INFO - [generated in 0.00084s] ('FR:desktop', 1755373213, 1)
2025-08-19 21:40:13,976 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:40:13,978 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:13,980 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:40:13,981 - sqlalchemy.engine.Engine - INFO - [generated in 0.00276s] (0.8, 1755373213, 'FR:desktop')
2025-08-19 21:40:13,986 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:40:13,989 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:40:13,990 - sqlalchemy.engine.Engine - INFO - [generated in 0.00188s] ('FR:desktop', 1, 0)
2025-08-19 21:40:13,995 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:40:14,006 - sqlalchemy.engine.Engine - INFO - [generated in 0.01055s] (1755632413, 'FR:desktop')
2025-08-19 21:40:14,011 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:40:14,016 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:40:14,018 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:14,020 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:40:14,022 - sqlalchemy.engine.Engine - INFO - [cached since 0.06101s ago] (0.0, 'FR:mobile', 1755373214, 'approved')
2025-08-19 21:40:14,025 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:40:14,026 - sqlalchemy.engine.Engine - INFO - [cached since 0.05508s ago] ('FR:mobile', 1755373214, 1)
2025-08-19 21:40:14,028 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:40:14,033 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:40:14,035 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:40:14,035 - sqlalchemy.engine.Engine - INFO - [cached since 0.05708s ago] (0.8, 1755373214, 'FR:mobile')
2025-08-19 21:40:14,038 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:40:14,041 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:40:14,041 - sqlalchemy.engine.Engine - INFO - [cached since 0.05287s ago] ('FR:mobile', 1, 0)
2025-08-19 21:40:14,043 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:40:14,043 - sqlalchemy.engine.Engine - INFO - [cached since 0.04883s ago] (1755632414, 'FR:mobile')
2025-08-19 21:40:14,045 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:40:14,047 - __main__ - INFO - DB session closed
2025-08-19 21:40:14,049 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:40:14 (took 0.10s)
2025-08-19 21:50:13,951 - __main__ - INFO - Starting autopilot iteration
2025-08-19 21:50:13,951 - __main__ - INFO - Fetching all segments
2025-08-19 21:50:13,968 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:50:13,972 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 21:50:13,973 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ()
2025-08-19 21:50:13,975 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 21:50:13,978 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:50:13,981 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.0, 'FR:desktop', 1755373813, 'approved')
2025-08-19 21:50:13,985 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:50:13,985 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1755373813, 1)
2025-08-19 21:50:13,991 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:50:13,991 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:50:13,992 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:50:13,993 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755373813, 'FR:desktop')
2025-08-19 21:50:13,993 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 21:50:13,998 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:50:14,000 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1, 0)
2025-08-19 21:50:14,001 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:50:14,001 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755633013, 'FR:desktop')
2025-08-19 21:50:14,004 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:50:14,014 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 21:50:14,017 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:50:14,019 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 21:50:14,019 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.0, 'FR:mobile', 1755373814, 'approved')
2025-08-19 21:50:14,022 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 21:50:14,022 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:mobile', 1755373814, 1)
2025-08-19 21:50:14,025 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 21:50:14,027 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 21:50:14,028 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 21:50:14,028 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755373814, 'FR:mobile')
2025-08-19 21:50:14,033 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 21:50:14,035 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 21:50:14,035 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:mobile', 1, 0)
2025-08-19 21:50:14,036 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 21:50:14,038 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755633014, 'FR:mobile')
2025-08-19 21:50:14,039 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 21:50:14,048 - __main__ - INFO - DB session closed
2025-08-19 21:50:14,049 - __main__ - INFO - Payout rates updated @ 2025-08-19 21:50:14 (took 0.10s)
2025-08-19 22:00:13,952 - __main__ - INFO - Starting autopilot iteration
2025-08-19 22:00:13,954 - __main__ - INFO - Fetching all segments
2025-08-19 22:00:13,962 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:13,964 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 22:00:13,966 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ()
2025-08-19 22:00:13,973 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 22:00:13,978 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:00:13,978 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:desktop', 1755374413, 'approved')
2025-08-19 22:00:13,981 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:00:13,981 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1755374413, 1)
2025-08-19 22:00:13,986 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:00:13,986 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:13,988 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:00:13,990 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755374413, 'FR:desktop')
2025-08-19 22:00:13,992 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 22:00:13,993 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:00:13,993 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1, 0)
2025-08-19 22:00:13,996 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:00:13,998 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755633613, 'FR:desktop')
2025-08-19 22:00:13,998 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:00:14,004 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 22:00:14,006 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:14,006 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:00:14,009 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:mobile', 1755374414, 'approved')
2025-08-19 22:00:14,009 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:00:14,009 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1755374414, 1)
2025-08-19 22:00:14,014 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:00:14,014 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:14,016 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:00:14,016 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755374414, 'FR:mobile')
2025-08-19 22:00:14,018 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 22:00:14,018 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:00:14,018 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1, 0)
2025-08-19 22:00:14,021 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:00:14,021 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755633614, 'FR:mobile')
2025-08-19 22:00:14,021 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:00:14,025 - __main__ - INFO - DB session closed
2025-08-19 22:00:14,027 - __main__ - INFO - Payout rates updated @ 2025-08-19 22:00:14 (took 0.07s)
2025-08-19 22:00:54,183 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 22:00:54,183 - __main__ - INFO - Initializing database...
2025-08-19 22:00:54,188 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:54,195 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 22:00:54,197 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:00:54,209 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 22:00:54,209 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:00:54,211 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 22:00:54,211 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:00:54,211 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 22:00:54,214 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:00:54,215 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 22:00:54,215 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:00:54,215 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 22:00:54,217 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:00:54,218 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:00:54,220 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 22:00:54,220 - __main__ - INFO - Ensuring default segments exist
2025-08-19 22:00:54,284 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:54,294 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:00:54,300 - sqlalchemy.engine.Engine - INFO - [generated in 0.00551s] ('FR:mobile', 1, 0)
2025-08-19 22:00:54,304 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:00:54,305 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:54,307 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:00:54,309 - sqlalchemy.engine.Engine - INFO - [cached since 0.01382s ago] ('FR:desktop', 1, 0)
2025-08-19 22:00:54,311 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:00:54,313 - __main__ - INFO - Default segments ensured
2025-08-19 22:00:54,314 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 22:00:54,314 - __main__ - INFO - Starting autopilot iteration
2025-08-19 22:00:54,315 - __main__ - INFO - Fetching all segments
2025-08-19 22:00:54,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:54,320 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 22:00:54,321 - sqlalchemy.engine.Engine - INFO - [generated in 0.00185s] ()
2025-08-19 22:00:54,325 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 22:00:54,331 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:00:54,331 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] (0.0, 'FR:desktop', 1755374454, 'approved')
2025-08-19 22:00:54,344 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:00:54,346 - sqlalchemy.engine.Engine - INFO - [generated in 0.00186s] ('FR:desktop', 1755374454, 1)
2025-08-19 22:00:54,350 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:00:54,352 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:54,357 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:00:54,361 - sqlalchemy.engine.Engine - INFO - [generated in 0.00507s] (0.8, 1755374454, 'FR:desktop')
2025-08-19 22:00:54,365 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 22:00:54,367 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:00:54,369 - sqlalchemy.engine.Engine - INFO - [generated in 0.00117s] ('FR:desktop', 1, 0)
2025-08-19 22:00:54,374 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:00:54,376 - sqlalchemy.engine.Engine - INFO - [generated in 0.00112s] (1755633654, 'FR:desktop')
2025-08-19 22:00:54,378 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:00:54,383 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 22:00:54,385 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:54,390 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:00:54,391 - sqlalchemy.engine.Engine - INFO - [cached since 0.05954s ago] (0.0, 'FR:mobile', 1755374454, 'approved')
2025-08-19 22:00:54,392 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:00:54,395 - sqlalchemy.engine.Engine - INFO - [cached since 0.04995s ago] ('FR:mobile', 1755374454, 1)
2025-08-19 22:00:54,396 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:00:54,396 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:00:54,398 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:00:54,400 - sqlalchemy.engine.Engine - INFO - [cached since 0.04349s ago] (0.8, 1755374454, 'FR:mobile')
2025-08-19 22:00:54,401 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 22:00:54,404 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:00:54,406 - sqlalchemy.engine.Engine - INFO - [cached since 0.03746s ago] ('FR:mobile', 1, 0)
2025-08-19 22:00:54,406 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:00:54,406 - sqlalchemy.engine.Engine - INFO - [cached since 0.03334s ago] (1755633654, 'FR:mobile')
2025-08-19 22:00:54,410 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:00:54,412 - __main__ - INFO - DB session closed
2025-08-19 22:00:54,412 - __main__ - INFO - Payout rates updated @ 2025-08-19 22:00:54 (took 0.10s)
2025-08-19 22:05:27,584 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 22:05:27,584 - __main__ - INFO - Initializing database...
2025-08-19 22:05:27,589 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:05:27,594 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 22:05:27,595 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:05:27,598 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 22:05:27,600 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:05:27,600 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 22:05:27,602 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:05:27,602 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 22:05:27,604 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:05:27,605 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 22:05:27,607 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:05:27,607 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 22:05:27,612 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:05:27,612 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:05:27,614 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 22:05:27,615 - __main__ - INFO - Ensuring default segments exist
2025-08-19 22:05:27,677 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:05:27,685 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:05:27,685 - sqlalchemy.engine.Engine - INFO - [generated in 0.00174s] ('FR:mobile', 1, 0)
2025-08-19 22:05:27,690 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:05:27,693 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:05:27,699 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:05:27,700 - sqlalchemy.engine.Engine - INFO - [cached since 0.01662s ago] ('FR:desktop', 1, 0)
2025-08-19 22:05:27,704 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:05:27,704 - __main__ - INFO - Default segments ensured
2025-08-19 22:05:27,706 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 22:05:27,706 - __main__ - INFO - Starting autopilot iteration
2025-08-19 22:05:27,708 - __main__ - INFO - Fetching all segments
2025-08-19 22:05:27,710 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:05:27,714 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 22:05:27,715 - sqlalchemy.engine.Engine - INFO - [generated in 0.00105s] ()
2025-08-19 22:05:27,717 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 22:05:27,723 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:05:27,723 - sqlalchemy.engine.Engine - INFO - [generated in 0.00096s] (0.0, 'FR:desktop', 1755374727, 'approved')
2025-08-19 22:05:27,732 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:05:27,732 - sqlalchemy.engine.Engine - INFO - [generated in 0.00099s] ('FR:desktop', 1755374727, 1)
2025-08-19 22:05:27,738 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:05:27,739 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:05:27,740 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:05:27,740 - sqlalchemy.engine.Engine - INFO - [generated in 0.00109s] (0.8, 1755374727, 'FR:desktop')
2025-08-19 22:05:27,749 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 22:05:27,757 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:05:27,766 - sqlalchemy.engine.Engine - INFO - [generated in 0.01047s] ('FR:desktop', 1, 0)
2025-08-19 22:05:27,783 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:05:27,788 - sqlalchemy.engine.Engine - INFO - [generated in 0.00441s] (1755633927, 'FR:desktop')
2025-08-19 22:05:27,797 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:05:27,804 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 22:05:27,806 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:05:27,809 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:05:27,812 - sqlalchemy.engine.Engine - INFO - [cached since 0.08859s ago] (0.0, 'FR:mobile', 1755374727, 'approved')
2025-08-19 22:05:27,814 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:05:27,816 - sqlalchemy.engine.Engine - INFO - [cached since 0.08231s ago] ('FR:mobile', 1755374727, 1)
2025-08-19 22:05:27,818 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:05:27,820 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:05:27,822 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:05:27,822 - sqlalchemy.engine.Engine - INFO - [cached since 0.08322s ago] (0.8, 1755374727, 'FR:mobile')
2025-08-19 22:05:27,829 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 22:05:27,831 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:05:27,832 - sqlalchemy.engine.Engine - INFO - [cached since 0.07531s ago] ('FR:mobile', 1, 0)
2025-08-19 22:05:27,835 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:05:27,835 - sqlalchemy.engine.Engine - INFO - [cached since 0.05251s ago] (1755633927, 'FR:mobile')
2025-08-19 22:05:27,837 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:05:27,841 - __main__ - INFO - DB session closed
2025-08-19 22:05:27,843 - __main__ - INFO - Payout rates updated @ 2025-08-19 22:05:27 (took 0.14s)
2025-08-19 22:15:27,711 - __main__ - INFO - Starting autopilot iteration
2025-08-19 22:15:27,736 - __main__ - INFO - Fetching all segments
2025-08-19 22:15:27,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:15:27,822 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 22:15:27,858 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ()
2025-08-19 22:15:27,933 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 22:15:27,939 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:15:27,945 - sqlalchemy.engine.Engine - INFO - [cached since 600.2s ago] (0.0, 'FR:desktop', 1755375327, 'approved')
2025-08-19 22:15:27,958 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:15:27,967 - sqlalchemy.engine.Engine - INFO - [cached since 600.2s ago] ('FR:desktop', 1755375327, 1)
2025-08-19 22:15:27,985 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:15:27,993 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:15:28,002 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:15:28,014 - sqlalchemy.engine.Engine - INFO - [cached since 600.3s ago] (0.8, 1755375327, 'FR:desktop')
2025-08-19 22:15:28,049 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 22:15:28,069 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:15:28,102 - sqlalchemy.engine.Engine - INFO - [cached since 600.3s ago] ('FR:desktop', 1, 0)
2025-08-19 22:15:28,121 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:15:28,131 - sqlalchemy.engine.Engine - INFO - [cached since 600.3s ago] (1755634528, 'FR:desktop')
2025-08-19 22:15:28,141 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:15:28,153 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 22:15:28,156 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:15:28,160 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:15:28,161 - sqlalchemy.engine.Engine - INFO - [cached since 600.4s ago] (0.0, 'FR:mobile', 1755375328, 'approved')
2025-08-19 22:15:28,163 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:15:28,168 - sqlalchemy.engine.Engine - INFO - [cached since 600.4s ago] ('FR:mobile', 1755375328, 1)
2025-08-19 22:15:28,172 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:15:28,176 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:15:28,179 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:15:28,181 - sqlalchemy.engine.Engine - INFO - [cached since 600.4s ago] (0.8, 1755375328, 'FR:mobile')
2025-08-19 22:15:28,186 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 22:15:28,188 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:15:28,190 - sqlalchemy.engine.Engine - INFO - [cached since 600.4s ago] ('FR:mobile', 1, 0)
2025-08-19 22:15:28,194 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:15:28,209 - sqlalchemy.engine.Engine - INFO - [cached since 600.4s ago] (1755634528, 'FR:mobile')
2025-08-19 22:15:28,213 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:15:28,227 - __main__ - INFO - DB session closed
2025-08-19 22:15:28,231 - __main__ - INFO - Payout rates updated @ 2025-08-19 22:15:28 (took 0.52s)
2025-08-19 22:19:54,425 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 22:19:54,427 - __main__ - INFO - Initializing database...
2025-08-19 22:19:54,432 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:19:54,432 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 22:19:54,432 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:19:54,440 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 22:19:54,440 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:19:54,443 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 22:19:54,444 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:19:54,444 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 22:19:54,446 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:19:54,447 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 22:19:54,449 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:19:54,450 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 22:19:54,450 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 22:19:54,452 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:19:54,453 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 22:19:54,453 - __main__ - INFO - Ensuring default segments exist
2025-08-19 22:19:54,511 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:19:54,520 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:19:54,521 - sqlalchemy.engine.Engine - INFO - [generated in 0.00204s] ('FR:mobile', 1, 0)
2025-08-19 22:19:54,524 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:19:54,529 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:19:54,531 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:19:54,532 - sqlalchemy.engine.Engine - INFO - [cached since 0.0126s ago] ('FR:desktop', 1, 0)
2025-08-19 22:19:54,534 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:19:54,534 - __main__ - INFO - Default segments ensured
2025-08-19 22:19:54,536 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 22:19:54,538 - __main__ - INFO - Starting autopilot iteration
2025-08-19 22:19:54,539 - __main__ - INFO - Fetching all segments
2025-08-19 22:19:54,540 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:19:54,546 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 22:19:54,546 - sqlalchemy.engine.Engine - INFO - [generated in 0.00108s] ()
2025-08-19 22:19:54,548 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 22:19:54,554 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:19:54,556 - sqlalchemy.engine.Engine - INFO - [generated in 0.00115s] (0.0, 'FR:desktop', 1755375594, 'approved')
2025-08-19 22:19:54,569 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:19:54,569 - sqlalchemy.engine.Engine - INFO - [generated in 0.00124s] ('FR:desktop', 1755375594, 1)
2025-08-19 22:19:54,574 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:19:54,577 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:19:54,579 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:19:54,579 - sqlalchemy.engine.Engine - INFO - [generated in 0.00105s] (0.8, 1755375594, 'FR:desktop')
2025-08-19 22:19:54,582 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 22:19:54,583 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:19:54,583 - sqlalchemy.engine.Engine - INFO - [generated in 0.00098s] ('FR:desktop', 1, 0)
2025-08-19 22:19:54,590 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:19:54,592 - sqlalchemy.engine.Engine - INFO - [generated in 0.00324s] (1755634794, 'FR:desktop')
2025-08-19 22:19:54,594 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:19:54,604 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 22:19:54,605 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:19:54,610 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:19:54,612 - sqlalchemy.engine.Engine - INFO - [cached since 0.05758s ago] (0.0, 'FR:mobile', 1755375594, 'approved')
2025-08-19 22:19:54,615 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:19:54,616 - sqlalchemy.engine.Engine - INFO - [cached since 0.04638s ago] ('FR:mobile', 1755375594, 1)
2025-08-19 22:19:54,619 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:19:54,619 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:19:54,621 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:19:54,622 - sqlalchemy.engine.Engine - INFO - [cached since 0.04381s ago] (0.8, 1755375594, 'FR:mobile')
2025-08-19 22:19:54,624 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 22:19:54,628 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:19:54,628 - sqlalchemy.engine.Engine - INFO - [cached since 0.04352s ago] ('FR:mobile', 1, 0)
2025-08-19 22:19:54,630 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:19:54,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.04083s ago] (1755634794, 'FR:mobile')
2025-08-19 22:19:54,631 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:19:54,635 - __main__ - INFO - DB session closed
2025-08-19 22:19:54,637 - __main__ - INFO - Payout rates updated @ 2025-08-19 22:19:54 (took 0.10s)
2025-08-19 22:29:54,550 - __main__ - INFO - Starting autopilot iteration
2025-08-19 22:29:54,563 - __main__ - INFO - Fetching all segments
2025-08-19 22:29:54,630 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:29:54,633 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 22:29:54,637 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ()
2025-08-19 22:29:54,641 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 22:29:54,646 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:29:54,655 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.0, 'FR:desktop', 1755376194, 'approved')
2025-08-19 22:29:54,661 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:29:54,684 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:desktop', 1755376194, 1)
2025-08-19 22:29:54,692 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:29:54,695 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:29:54,700 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:29:54,700 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.8, 1755376194, 'FR:desktop')
2025-08-19 22:29:54,708 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 22:29:54,722 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:29:54,735 - sqlalchemy.engine.Engine - INFO - [cached since 600.2s ago] ('FR:desktop', 1, 0)
2025-08-19 22:29:54,746 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:29:54,760 - sqlalchemy.engine.Engine - INFO - [cached since 600.2s ago] (1755635394, 'FR:desktop')
2025-08-19 22:29:54,780 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:29:54,860 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 22:29:54,879 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:29:54,895 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:29:54,897 - sqlalchemy.engine.Engine - INFO - [cached since 600.3s ago] (0.0, 'FR:mobile', 1755376194, 'approved')
2025-08-19 22:29:54,917 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:29:54,929 - sqlalchemy.engine.Engine - INFO - [cached since 600.4s ago] ('FR:mobile', 1755376194, 1)
2025-08-19 22:29:54,940 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:29:54,950 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:29:54,952 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:29:54,954 - sqlalchemy.engine.Engine - INFO - [cached since 600.4s ago] (0.8, 1755376194, 'FR:mobile')
2025-08-19 22:29:54,956 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 22:29:54,960 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:29:54,980 - sqlalchemy.engine.Engine - INFO - [cached since 600.4s ago] ('FR:mobile', 1, 0)
2025-08-19 22:29:54,988 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:29:55,015 - sqlalchemy.engine.Engine - INFO - [cached since 600.4s ago] (1755635394, 'FR:mobile')
2025-08-19 22:29:55,054 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:29:55,138 - __main__ - INFO - DB session closed
2025-08-19 22:29:55,165 - __main__ - INFO - Payout rates updated @ 2025-08-19 22:29:55 (took 0.61s)
2025-08-19 22:39:54,552 - __main__ - INFO - Starting autopilot iteration
2025-08-19 22:39:54,552 - __main__ - INFO - Fetching all segments
2025-08-19 22:39:54,567 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:39:54,567 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 22:39:54,569 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ()
2025-08-19 22:39:54,572 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 22:39:54,576 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:39:54,576 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:desktop', 1755376794, 'approved')
2025-08-19 22:39:54,580 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:39:54,581 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1755376794, 1)
2025-08-19 22:39:54,583 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:39:54,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:39:54,586 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:39:54,586 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755376794, 'FR:desktop')
2025-08-19 22:39:54,594 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 22:39:54,595 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:39:54,596 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1, 0)
2025-08-19 22:39:54,598 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:39:54,599 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755635994, 'FR:desktop')
2025-08-19 22:39:54,601 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:39:54,611 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 22:39:54,612 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:39:54,614 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:39:54,615 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:mobile', 1755376794, 'approved')
2025-08-19 22:39:54,617 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:39:54,618 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1755376794, 1)
2025-08-19 22:39:54,621 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:39:54,622 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:39:54,623 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:39:54,625 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755376794, 'FR:mobile')
2025-08-19 22:39:54,628 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 22:39:54,629 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:39:54,630 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1, 0)
2025-08-19 22:39:54,632 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:39:54,633 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755635994, 'FR:mobile')
2025-08-19 22:39:54,635 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:39:54,644 - __main__ - INFO - DB session closed
2025-08-19 22:39:54,645 - __main__ - INFO - Payout rates updated @ 2025-08-19 22:39:54 (took 0.09s)
2025-08-19 22:49:54,553 - __main__ - INFO - Starting autopilot iteration
2025-08-19 22:49:54,553 - __main__ - INFO - Fetching all segments
2025-08-19 22:49:54,566 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:49:54,568 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 22:49:54,569 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ()
2025-08-19 22:49:54,574 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 22:49:54,577 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:49:54,579 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.0, 'FR:desktop', 1755377394, 'approved')
2025-08-19 22:49:54,582 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:49:54,582 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:desktop', 1755377394, 1)
2025-08-19 22:49:54,582 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:49:54,587 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:49:54,589 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:49:54,593 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.8, 1755377394, 'FR:desktop')
2025-08-19 22:49:54,593 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 22:49:54,596 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:49:54,597 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:desktop', 1, 0)
2025-08-19 22:49:54,597 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:49:54,597 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (1755636594, 'FR:desktop')
2025-08-19 22:49:54,597 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:49:54,612 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 22:49:54,612 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:49:54,615 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:49:54,615 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.0, 'FR:mobile', 1755377394, 'approved')
2025-08-19 22:49:54,618 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:49:54,618 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:mobile', 1755377394, 1)
2025-08-19 22:49:54,619 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:49:54,624 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:49:54,626 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:49:54,628 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (0.8, 1755377394, 'FR:mobile')
2025-08-19 22:49:54,630 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 22:49:54,632 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:49:54,632 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] ('FR:mobile', 1, 0)
2025-08-19 22:49:54,634 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:49:54,634 - sqlalchemy.engine.Engine - INFO - [cached since 1800s ago] (1755636594, 'FR:mobile')
2025-08-19 22:49:54,634 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:49:54,643 - __main__ - INFO - DB session closed
2025-08-19 22:49:54,643 - __main__ - INFO - Payout rates updated @ 2025-08-19 22:49:54 (took 0.09s)
2025-08-19 22:59:54,554 - __main__ - INFO - Starting autopilot iteration
2025-08-19 22:59:54,558 - __main__ - INFO - Fetching all segments
2025-08-19 22:59:54,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:59:54,593 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 22:59:54,595 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ()
2025-08-19 22:59:54,604 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 22:59:54,608 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:59:54,609 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.0, 'FR:desktop', 1755377994, 'approved')
2025-08-19 22:59:54,614 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:59:54,614 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:desktop', 1755377994, 1)
2025-08-19 22:59:54,617 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:59:54,618 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:59:54,620 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:59:54,622 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.8, 1755377994, 'FR:desktop')
2025-08-19 22:59:54,622 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 22:59:54,627 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:59:54,627 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:desktop', 1, 0)
2025-08-19 22:59:54,631 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:59:54,632 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (1755637194, 'FR:desktop')
2025-08-19 22:59:54,632 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:59:54,645 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 22:59:54,646 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:59:54,647 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 22:59:54,648 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.0, 'FR:mobile', 1755377994, 'approved')
2025-08-19 22:59:54,650 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 22:59:54,651 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:mobile', 1755377994, 1)
2025-08-19 22:59:54,652 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 22:59:54,654 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 22:59:54,655 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 22:59:54,656 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (0.8, 1755377994, 'FR:mobile')
2025-08-19 22:59:54,659 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 22:59:54,660 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 22:59:54,660 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] ('FR:mobile', 1, 0)
2025-08-19 22:59:54,662 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 22:59:54,662 - sqlalchemy.engine.Engine - INFO - [cached since 2400s ago] (1755637194, 'FR:mobile')
2025-08-19 22:59:54,664 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 22:59:54,668 - __main__ - INFO - DB session closed
2025-08-19 22:59:54,668 - __main__ - INFO - Payout rates updated @ 2025-08-19 22:59:54 (took 0.11s)
2025-08-19 23:09:54,554 - __main__ - INFO - Starting autopilot iteration
2025-08-19 23:09:54,554 - __main__ - INFO - Fetching all segments
2025-08-19 23:09:54,565 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:09:54,565 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 23:09:54,568 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ()
2025-08-19 23:09:54,572 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 23:09:54,576 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:09:54,577 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.0, 'FR:desktop', 1755378594, 'approved')
2025-08-19 23:09:54,580 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:09:54,580 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:desktop', 1755378594, 1)
2025-08-19 23:09:54,583 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:09:54,585 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:09:54,586 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:09:54,588 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.8, 1755378594, 'FR:desktop')
2025-08-19 23:09:54,591 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 23:09:54,592 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:09:54,593 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:desktop', 1, 0)
2025-08-19 23:09:54,595 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:09:54,596 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (1755637794, 'FR:desktop')
2025-08-19 23:09:54,597 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:09:54,604 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 23:09:54,605 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:09:54,606 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:09:54,607 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.0, 'FR:mobile', 1755378594, 'approved')
2025-08-19 23:09:54,610 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:09:54,610 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:mobile', 1755378594, 1)
2025-08-19 23:09:54,613 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:09:54,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:09:54,615 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:09:54,616 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (0.8, 1755378594, 'FR:mobile')
2025-08-19 23:09:54,619 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 23:09:54,620 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:09:54,622 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] ('FR:mobile', 1, 0)
2025-08-19 23:09:54,623 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:09:54,624 - sqlalchemy.engine.Engine - INFO - [cached since 3000s ago] (1755637794, 'FR:mobile')
2025-08-19 23:09:54,626 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:09:54,629 - __main__ - INFO - DB session closed
2025-08-19 23:09:54,629 - __main__ - INFO - Payout rates updated @ 2025-08-19 23:09:54 (took 0.08s)
2025-08-19 23:12:33,537 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 23:12:33,538 - __main__ - INFO - Initializing database...
2025-08-19 23:12:33,544 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:12:33,547 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 23:12:33,549 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:12:33,557 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 23:12:33,557 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:12:33,559 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 23:12:33,561 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:12:33,565 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 23:12:33,567 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:12:33,569 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 23:12:33,569 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:12:33,571 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 23:12:33,572 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:12:33,574 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:12:33,574 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 23:12:33,577 - __main__ - INFO - Ensuring default segments exist
2025-08-19 23:12:33,643 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:12:33,650 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:12:33,650 - sqlalchemy.engine.Engine - INFO - [generated in 0.00169s] ('FR:mobile', 1, 0)
2025-08-19 23:12:33,654 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:12:33,657 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:12:33,660 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:12:33,665 - sqlalchemy.engine.Engine - INFO - [cached since 0.01702s ago] ('FR:desktop', 1, 0)
2025-08-19 23:12:33,669 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:12:33,669 - __main__ - INFO - Default segments ensured
2025-08-19 23:12:33,672 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 23:12:33,672 - __main__ - INFO - Starting autopilot iteration
2025-08-19 23:12:33,674 - __main__ - INFO - Fetching all segments
2025-08-19 23:12:33,676 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:12:33,677 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 23:12:33,680 - sqlalchemy.engine.Engine - INFO - [generated in 0.00349s] ()
2025-08-19 23:12:33,682 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 23:12:33,688 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:12:33,690 - sqlalchemy.engine.Engine - INFO - [generated in 0.00114s] (0.0, 'FR:desktop', 1755378753, 'approved')
2025-08-19 23:12:33,700 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:12:33,702 - sqlalchemy.engine.Engine - INFO - [generated in 0.00168s] ('FR:desktop', 1755378753, 1)
2025-08-19 23:12:33,704 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:12:33,704 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:12:33,707 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:12:33,708 - sqlalchemy.engine.Engine - INFO - [generated in 0.00133s] (0.8, 1755378753, 'FR:desktop')
2025-08-19 23:12:33,712 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 23:12:33,715 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:12:33,715 - sqlalchemy.engine.Engine - INFO - [generated in 0.00145s] ('FR:desktop', 1, 0)
2025-08-19 23:12:33,720 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:12:33,722 - sqlalchemy.engine.Engine - INFO - [generated in 0.00138s] (1755637953, 'FR:desktop')
2025-08-19 23:12:33,723 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:12:33,727 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 23:12:33,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:12:33,732 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:12:33,732 - sqlalchemy.engine.Engine - INFO - [cached since 0.04467s ago] (0.0, 'FR:mobile', 1755378753, 'approved')
2025-08-19 23:12:33,736 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:12:33,738 - sqlalchemy.engine.Engine - INFO - [cached since 0.037s ago] ('FR:mobile', 1755378753, 1)
2025-08-19 23:12:33,740 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:12:33,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:12:33,742 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:12:33,743 - sqlalchemy.engine.Engine - INFO - [cached since 0.03559s ago] (0.8, 1755378753, 'FR:mobile')
2025-08-19 23:12:33,746 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 23:12:33,748 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:12:33,748 - sqlalchemy.engine.Engine - INFO - [cached since 0.03374s ago] ('FR:mobile', 1, 0)
2025-08-19 23:12:33,750 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:12:33,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.03147s ago] (1755637953, 'FR:mobile')
2025-08-19 23:12:33,753 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:12:33,756 - __main__ - INFO - DB session closed
2025-08-19 23:12:33,758 - __main__ - INFO - Payout rates updated @ 2025-08-19 23:12:33 (took 0.09s)
2025-08-19 23:22:33,678 - __main__ - INFO - Starting autopilot iteration
2025-08-19 23:22:33,679 - __main__ - INFO - Fetching all segments
2025-08-19 23:22:33,682 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:22:33,685 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 23:22:33,686 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ()
2025-08-19 23:22:33,688 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 23:22:33,690 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:22:33,692 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.0, 'FR:desktop', 1755379353, 'approved')
2025-08-19 23:22:33,697 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:22:33,699 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1755379353, 1)
2025-08-19 23:22:33,702 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:22:33,703 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:22:33,704 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:22:33,705 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755379353, 'FR:desktop')
2025-08-19 23:22:33,709 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 23:22:33,712 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:22:33,714 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1, 0)
2025-08-19 23:22:33,717 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:22:33,718 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755638553, 'FR:desktop')
2025-08-19 23:22:33,719 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:22:33,727 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 23:22:33,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:22:33,732 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:22:33,733 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.0, 'FR:mobile', 1755379353, 'approved')
2025-08-19 23:22:33,736 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:22:33,736 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:mobile', 1755379353, 1)
2025-08-19 23:22:33,739 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:22:33,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:22:33,742 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:22:33,743 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755379353, 'FR:mobile')
2025-08-19 23:22:33,746 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 23:22:33,748 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:22:33,749 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:mobile', 1, 0)
2025-08-19 23:22:33,751 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:22:33,752 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755638553, 'FR:mobile')
2025-08-19 23:22:33,753 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:22:33,762 - __main__ - INFO - DB session closed
2025-08-19 23:22:33,763 - __main__ - INFO - Payout rates updated @ 2025-08-19 23:22:33 (took 0.08s)
2025-08-19 23:28:15,013 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 23:28:15,016 - __main__ - INFO - Initializing database...
2025-08-19 23:28:15,020 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:28:15,023 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 23:28:15,028 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:28:15,047 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 23:28:15,047 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:28:15,047 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 23:28:15,051 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:28:15,051 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 23:28:15,053 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:28:15,057 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 23:28:15,060 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:28:15,061 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 23:28:15,063 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:28:15,065 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:28:15,068 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 23:28:15,071 - __main__ - INFO - Ensuring default segments exist
2025-08-19 23:28:15,140 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:28:15,148 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:28:15,148 - sqlalchemy.engine.Engine - INFO - [generated in 0.00162s] ('FR:mobile', 1, 0)
2025-08-19 23:28:15,155 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:28:15,160 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:28:15,165 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:28:15,169 - sqlalchemy.engine.Engine - INFO - [cached since 0.02173s ago] ('FR:desktop', 1, 0)
2025-08-19 23:28:15,174 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:28:15,176 - __main__ - INFO - Default segments ensured
2025-08-19 23:28:15,177 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 23:28:15,178 - __main__ - INFO - Starting autopilot iteration
2025-08-19 23:28:15,179 - __main__ - INFO - Fetching all segments
2025-08-19 23:28:15,180 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:28:15,183 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 23:28:15,184 - sqlalchemy.engine.Engine - INFO - [generated in 0.00139s] ()
2025-08-19 23:28:15,189 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 23:28:15,192 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:28:15,194 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] (0.0, 'FR:desktop', 1755379695, 'approved')
2025-08-19 23:28:15,206 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:28:15,208 - sqlalchemy.engine.Engine - INFO - [generated in 0.00110s] ('FR:desktop', 1755379695, 1)
2025-08-19 23:28:15,210 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:28:15,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:28:15,213 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:28:15,213 - sqlalchemy.engine.Engine - INFO - [generated in 0.00128s] (0.8, 1755379695, 'FR:desktop')
2025-08-19 23:28:15,216 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 23:28:15,222 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:28:15,223 - sqlalchemy.engine.Engine - INFO - [generated in 0.00150s] ('FR:desktop', 1, 0)
2025-08-19 23:28:15,227 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:28:15,229 - sqlalchemy.engine.Engine - INFO - [generated in 0.00087s] (1755638895, 'FR:desktop')
2025-08-19 23:28:15,231 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:28:15,238 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 23:28:15,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:28:15,242 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:28:15,243 - sqlalchemy.engine.Engine - INFO - [cached since 0.04939s ago] (0.0, 'FR:mobile', 1755379695, 'approved')
2025-08-19 23:28:15,244 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:28:15,247 - sqlalchemy.engine.Engine - INFO - [cached since 0.03959s ago] ('FR:mobile', 1755379695, 1)
2025-08-19 23:28:15,248 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:28:15,250 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:28:15,252 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:28:15,254 - sqlalchemy.engine.Engine - INFO - [cached since 0.04128s ago] (0.8, 1755379695, 'FR:mobile')
2025-08-19 23:28:15,256 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 23:28:15,256 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:28:15,259 - sqlalchemy.engine.Engine - INFO - [cached since 0.03596s ago] ('FR:mobile', 1, 0)
2025-08-19 23:28:15,260 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:28:15,260 - sqlalchemy.engine.Engine - INFO - [cached since 0.03337s ago] (1755638895, 'FR:mobile')
2025-08-19 23:28:15,264 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:28:15,266 - __main__ - INFO - DB session closed
2025-08-19 23:28:15,266 - __main__ - INFO - Payout rates updated @ 2025-08-19 23:28:15 (took 0.09s)
2025-08-19 23:38:15,179 - __main__ - INFO - Starting autopilot iteration
2025-08-19 23:38:15,179 - __main__ - INFO - Fetching all segments
2025-08-19 23:38:15,183 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:38:15,183 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 23:38:15,183 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ()
2025-08-19 23:38:15,188 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 23:38:15,191 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:38:15,192 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.0, 'FR:desktop', 1755380295, 'approved')
2025-08-19 23:38:15,193 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:38:15,196 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1755380295, 1)
2025-08-19 23:38:15,196 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:38:15,196 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:38:15,196 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:38:15,202 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755380295, 'FR:desktop')
2025-08-19 23:38:15,203 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 23:38:15,203 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:38:15,206 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:desktop', 1, 0)
2025-08-19 23:38:15,206 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:38:15,206 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755639495, 'FR:desktop')
2025-08-19 23:38:15,206 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:38:15,218 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 23:38:15,219 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:38:15,221 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:38:15,221 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.0, 'FR:mobile', 1755380295, 'approved')
2025-08-19 23:38:15,221 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:38:15,221 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:mobile', 1755380295, 1)
2025-08-19 23:38:15,227 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:38:15,227 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:38:15,228 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:38:15,229 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (0.8, 1755380295, 'FR:mobile')
2025-08-19 23:38:15,231 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 23:38:15,231 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:38:15,233 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] ('FR:mobile', 1, 0)
2025-08-19 23:38:15,236 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:38:15,236 - sqlalchemy.engine.Engine - INFO - [cached since 600s ago] (1755639495, 'FR:mobile')
2025-08-19 23:38:15,238 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:38:15,240 - __main__ - INFO - DB session closed
2025-08-19 23:38:15,242 - __main__ - INFO - Payout rates updated @ 2025-08-19 23:38:15 (took 0.06s)
2025-08-19 23:48:15,180 - __main__ - INFO - Starting autopilot iteration
2025-08-19 23:48:15,181 - __main__ - INFO - Fetching all segments
2025-08-19 23:48:15,183 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:48:15,185 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 23:48:15,186 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ()
2025-08-19 23:48:15,190 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 23:48:15,191 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:48:15,192 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:desktop', 1755380895, 'approved')
2025-08-19 23:48:15,196 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:48:15,197 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1755380895, 1)
2025-08-19 23:48:15,200 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:48:15,201 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:48:15,203 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:48:15,204 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755380895, 'FR:desktop')
2025-08-19 23:48:15,206 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 23:48:15,208 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:48:15,209 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:desktop', 1, 0)
2025-08-19 23:48:15,211 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:48:15,212 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755640095, 'FR:desktop')
2025-08-19 23:48:15,214 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:48:15,219 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 23:48:15,220 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:48:15,222 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:48:15,223 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.0, 'FR:mobile', 1755380895, 'approved')
2025-08-19 23:48:15,225 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:48:15,226 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1755380895, 1)
2025-08-19 23:48:15,228 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:48:15,230 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:48:15,231 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:48:15,232 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (0.8, 1755380895, 'FR:mobile')
2025-08-19 23:48:15,235 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 23:48:15,236 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:48:15,237 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] ('FR:mobile', 1, 0)
2025-08-19 23:48:15,239 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:48:15,240 - sqlalchemy.engine.Engine - INFO - [cached since 1200s ago] (1755640095, 'FR:mobile')
2025-08-19 23:48:15,242 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:48:15,245 - __main__ - INFO - DB session closed
2025-08-19 23:48:15,245 - __main__ - INFO - Payout rates updated @ 2025-08-19 23:48:15 (took 0.06s)
2025-08-19 23:58:49,550 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-19 23:58:49,550 - __main__ - INFO - Initializing database...
2025-08-19 23:58:49,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:58:49,555 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-19 23:58:49,557 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:58:49,561 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-19 23:58:49,562 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:58:49,565 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-19 23:58:49,565 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:58:49,567 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-19 23:58:49,569 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:58:49,572 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-19 23:58:49,572 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:58:49,573 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-19 23:58:49,574 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-19 23:58:49,574 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:58:49,574 - src.soft.storage - INFO - Database tables created successfully
2025-08-19 23:58:49,574 - __main__ - INFO - Ensuring default segments exist
2025-08-19 23:58:49,629 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:58:49,640 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:58:49,642 - sqlalchemy.engine.Engine - INFO - [generated in 0.00219s] ('FR:mobile', 1, 0)
2025-08-19 23:58:49,647 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:58:49,648 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:58:49,654 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:58:49,657 - sqlalchemy.engine.Engine - INFO - [cached since 0.01808s ago] ('FR:desktop', 1, 0)
2025-08-19 23:58:49,661 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:58:49,662 - __main__ - INFO - Default segments ensured
2025-08-19 23:58:49,664 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-19 23:58:49,664 - __main__ - INFO - Starting autopilot iteration
2025-08-19 23:58:49,666 - __main__ - INFO - Fetching all segments
2025-08-19 23:58:49,668 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:58:49,670 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-19 23:58:49,670 - sqlalchemy.engine.Engine - INFO - [generated in 0.00112s] ()
2025-08-19 23:58:49,670 - __main__ - INFO - Processing segment: FR:desktop
2025-08-19 23:58:49,678 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:58:49,679 - sqlalchemy.engine.Engine - INFO - [generated in 0.00141s] (0.0, 'FR:desktop', 1755381529, 'approved')
2025-08-19 23:58:49,691 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:58:49,693 - sqlalchemy.engine.Engine - INFO - [generated in 0.00102s] ('FR:desktop', 1755381529, 1)
2025-08-19 23:58:49,696 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:58:49,698 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:58:49,703 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:58:49,705 - sqlalchemy.engine.Engine - INFO - [generated in 0.00162s] (0.8, 1755381529, 'FR:desktop')
2025-08-19 23:58:49,708 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-19 23:58:49,709 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:58:49,712 - sqlalchemy.engine.Engine - INFO - [generated in 0.00104s] ('FR:desktop', 1, 0)
2025-08-19 23:58:49,715 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:58:49,719 - sqlalchemy.engine.Engine - INFO - [generated in 0.00339s] (1755640729, 'FR:desktop')
2025-08-19 23:58:49,722 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:58:49,726 - __main__ - INFO - Processing segment: FR:mobile
2025-08-19 23:58:49,733 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:58:49,736 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-19 23:58:49,738 - sqlalchemy.engine.Engine - INFO - [cached since 0.0601s ago] (0.0, 'FR:mobile', 1755381529, 'approved')
2025-08-19 23:58:49,741 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-19 23:58:49,741 - sqlalchemy.engine.Engine - INFO - [cached since 0.04996s ago] ('FR:mobile', 1755381529, 1)
2025-08-19 23:58:49,744 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-19 23:58:49,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-19 23:58:49,747 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-19 23:58:49,748 - sqlalchemy.engine.Engine - INFO - [cached since 0.04419s ago] (0.8, 1755381529, 'FR:mobile')
2025-08-19 23:58:49,750 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-19 23:58:49,753 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-19 23:58:49,755 - sqlalchemy.engine.Engine - INFO - [cached since 0.04437s ago] ('FR:mobile', 1, 0)
2025-08-19 23:58:49,755 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-19 23:58:49,755 - sqlalchemy.engine.Engine - INFO - [cached since 0.04184s ago] (1755640729, 'FR:mobile')
2025-08-19 23:58:49,759 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-19 23:58:49,762 - __main__ - INFO - DB session closed
2025-08-19 23:58:49,762 - __main__ - INFO - Payout rates updated @ 2025-08-19 23:58:49 (took 0.10s)
2025-08-20 00:06:42,060 - __main__ - INFO - Starting SmartLinks Autopilot
2025-08-20 00:06:42,066 - __main__ - INFO - Initializing database...
2025-08-20 00:06:42,070 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:06:42,074 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("offers")
2025-08-20 00:06:42,074 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-20 00:06:42,078 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("segments")
2025-08-20 00:06:42,080 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-20 00:06:42,082 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("creators")
2025-08-20 00:06:42,084 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-20 00:06:42,085 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("clicks")
2025-08-20 00:06:42,089 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-20 00:06:42,093 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("conversions")
2025-08-20 00:06:42,095 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-20 00:06:42,097 - sqlalchemy.engine.Engine - INFO - PRAGMA main.table_info("payout_rates")
2025-08-20 00:06:42,099 - sqlalchemy.engine.Engine - INFO - [raw sql] ()
2025-08-20 00:06:42,099 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-20 00:06:42,101 - src.soft.storage - INFO - Database tables created successfully
2025-08-20 00:06:42,106 - __main__ - INFO - Ensuring default segments exist
2025-08-20 00:06:42,176 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:06:42,192 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-20 00:06:42,193 - sqlalchemy.engine.Engine - INFO - [generated in 0.00238s] ('FR:mobile', 1, 0)
2025-08-20 00:06:42,197 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-20 00:06:42,200 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:06:42,204 - sqlalchemy.engine.Engine - INFO - SELECT segments.segment_id AS segments_segment_id, segments.geo AS segments_geo, segments.device AS segments_device 
FROM segments 
WHERE segments.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-20 00:06:42,206 - sqlalchemy.engine.Engine - INFO - [cached since 0.0151s ago] ('FR:desktop', 1, 0)
2025-08-20 00:06:42,212 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-20 00:06:42,216 - __main__ - INFO - Default segments ensured
2025-08-20 00:06:42,218 - __main__ - INFO - Starting autopilot with interval: 600 seconds
2025-08-20 00:06:42,219 - __main__ - INFO - Starting autopilot iteration
2025-08-20 00:06:42,223 - __main__ - INFO - Fetching all segments
2025-08-20 00:06:42,225 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:06:42,230 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-20 00:06:42,233 - sqlalchemy.engine.Engine - INFO - [generated in 0.00262s] ()
2025-08-20 00:06:42,235 - __main__ - INFO - Processing segment: FR:desktop
2025-08-20 00:06:42,243 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-20 00:06:42,244 - sqlalchemy.engine.Engine - INFO - [generated in 0.00189s] (0.0, 'FR:desktop', 1755382002, 'approved')
2025-08-20 00:06:42,256 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-20 00:06:42,263 - sqlalchemy.engine.Engine - INFO - [generated in 0.00529s] ('FR:desktop', 1755382002, 1)
2025-08-20 00:06:42,267 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-20 00:06:42,269 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:06:42,271 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-20 00:06:42,275 - sqlalchemy.engine.Engine - INFO - [generated in 0.00463s] (0.8, 1755382002, 'FR:desktop')
2025-08-20 00:06:42,280 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-20 00:06:42,282 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-20 00:06:42,285 - sqlalchemy.engine.Engine - INFO - [generated in 0.00140s] ('FR:desktop', 1, 0)
2025-08-20 00:06:42,289 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-20 00:06:42,290 - sqlalchemy.engine.Engine - INFO - [generated in 0.00215s] (1755641202, 'FR:desktop')
2025-08-20 00:06:42,292 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-20 00:06:42,301 - __main__ - INFO - Processing segment: FR:mobile
2025-08-20 00:06:42,313 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:06:42,318 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-20 00:06:42,318 - sqlalchemy.engine.Engine - INFO - [cached since 0.07689s ago] (0.0, 'FR:mobile', 1755382002, 'approved')
2025-08-20 00:06:42,324 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-20 00:06:42,326 - sqlalchemy.engine.Engine - INFO - [cached since 0.068s ago] ('FR:mobile', 1755382002, 1)
2025-08-20 00:06:42,328 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-20 00:06:42,329 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:06:42,330 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-20 00:06:42,332 - sqlalchemy.engine.Engine - INFO - [cached since 0.06192s ago] (0.8, 1755382002, 'FR:mobile')
2025-08-20 00:06:42,334 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-20 00:06:42,336 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-20 00:06:42,338 - sqlalchemy.engine.Engine - INFO - [cached since 0.05482s ago] ('FR:mobile', 1, 0)
2025-08-20 00:06:42,342 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-20 00:06:42,343 - sqlalchemy.engine.Engine - INFO - [cached since 0.05385s ago] (1755641202, 'FR:mobile')
2025-08-20 00:06:42,344 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-20 00:06:42,347 - __main__ - INFO - DB session closed
2025-08-20 00:06:42,349 - __main__ - INFO - Payout rates updated @ 2025-08-20 00:06:42 (took 0.13s)
2025-08-20 00:16:42,249 - __main__ - INFO - Starting autopilot iteration
2025-08-20 00:16:42,264 - __main__ - INFO - Fetching all segments
2025-08-20 00:16:42,295 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:16:42,300 - sqlalchemy.engine.Engine - INFO - SELECT segment_id FROM segments
2025-08-20 00:16:42,306 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ()
2025-08-20 00:16:42,312 - __main__ - INFO - Processing segment: FR:desktop
2025-08-20 00:16:42,315 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-20 00:16:42,327 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.0, 'FR:desktop', 1755382602, 'approved')
2025-08-20 00:16:42,331 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-20 00:16:42,332 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:desktop', 1755382602, 1)
2025-08-20 00:16:42,336 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-20 00:16:42,343 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:16:42,343 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-20 00:16:42,343 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.8, 1755382602, 'FR:desktop')
2025-08-20 00:16:42,348 - __main__ - INFO - Setting payout for FR:desktop: 5.0
2025-08-20 00:16:42,349 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-20 00:16:42,349 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:desktop', 1, 0)
2025-08-20 00:16:42,353 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-20 00:16:42,357 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (1755641802, 'FR:desktop')
2025-08-20 00:16:42,359 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-20 00:16:42,365 - __main__ - INFO - Processing segment: FR:mobile
2025-08-20 00:16:42,365 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:16:42,376 - sqlalchemy.engine.Engine - INFO - SELECT coalesce(sum(conversions.revenue), ?) AS total_revenue 
FROM conversions JOIN clicks ON clicks.click_id = conversions.click_id 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND conversions.status = ?
2025-08-20 00:16:42,378 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] (0.0, 'FR:mobile', 1755382602, 'approved')
2025-08-20 00:16:42,387 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT clicks.click_id AS clicks_click_id, clicks.ts AS clicks_ts, clicks.creator_id AS clicks_creator_id, clicks.slug AS clicks_slug, clicks.segment_id AS clicks_segment_id, clicks.geo AS clicks_geo, clicks.device AS clicks_device, clicks.fp AS clicks_fp, clicks.valid_final AS clicks_valid_final, clicks.risk AS clicks_risk, clicks.offer_id AS clicks_offer_id 
FROM clicks 
WHERE clicks.segment_id = ? AND clicks.ts >= ? AND clicks.valid_final = ?) AS anon_1
2025-08-20 00:16:42,393 - sqlalchemy.engine.Engine - INFO - [cached since 600.1s ago] ('FR:mobile', 1755382602, 1)
2025-08-20 00:16:42,405 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-08-20 00:16:42,419 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-08-20 00:16:42,425 - sqlalchemy.engine.Engine - INFO - 
                SELECT COALESCE(AVG(CASE WHEN risk >= ? THEN 1.0 ELSE 0.0 END), 0.0)
                FROM clicks 
                WHERE ts >= ? AND segment_id = ?
            
2025-08-20 00:16:42,426 - sqlalchemy.engine.Engine - INFO - [cached since 600.2s ago] (0.8, 1755382602, 'FR:mobile')
2025-08-20 00:16:42,433 - __main__ - INFO - Setting payout for FR:mobile: 5.0
2025-08-20 00:16:42,434 - sqlalchemy.engine.Engine - INFO - SELECT payout_rates.segment_id AS payout_rates_segment_id, payout_rates.payout AS payout_rates_payout, payout_rates.updated_at AS payout_rates_updated_at 
FROM payout_rates 
WHERE payout_rates.segment_id = ?
 LIMIT ? OFFSET ?
2025-08-20 00:16:42,434 - sqlalchemy.engine.Engine - INFO - [cached since 600.2s ago] ('FR:mobile', 1, 0)
2025-08-20 00:16:42,439 - sqlalchemy.engine.Engine - INFO - UPDATE payout_rates SET updated_at=? WHERE payout_rates.segment_id = ?
2025-08-20 00:16:42,443 - sqlalchemy.engine.Engine - INFO - [cached since 600.2s ago] (1755641802, 'FR:mobile')
2025-08-20 00:16:42,444 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-08-20 00:16:42,452 - __main__ - INFO - DB session closed
2025-08-20 00:16:42,452 - __main__ - INFO - Payout rates updated @ 2025-08-20 00:16:42 (took 0.20s)
